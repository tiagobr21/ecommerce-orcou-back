{"version":3,"file":"nebular-auth.mjs","sources":["../../../src/framework/auth/auth.options.ts","../../../src/framework/auth/helpers.ts","../../../src/framework/auth/services/token/token.ts","../../../src/framework/auth/services/token/token-parceler.ts","../../../src/framework/auth/services/token/token-storage.ts","../../../src/framework/auth/services/token/token.service.ts","../../../src/framework/auth/services/auth.service.ts","../../../src/framework/auth/strategies/auth-strategy.ts","../../../src/framework/auth/services/auth-result.ts","../../../src/framework/auth/strategies/auth-strategy-options.ts","../../../src/framework/auth/strategies/dummy/dummy-strategy-options.ts","../../../src/framework/auth/strategies/dummy/dummy-strategy.ts","../../../src/framework/auth/strategies/oauth2/oauth2-strategy.options.ts","../../../src/framework/auth/strategies/oauth2/oauth2-strategy.ts","../../../src/framework/auth/strategies/password/password-strategy-options.ts","../../../src/framework/auth/strategies/password/password-strategy.ts","../../../src/framework/auth/components/auth-block/auth-block.component.ts","../../../src/framework/auth/components/auth.component.ts","../../../src/framework/auth/components/login/login.component.ts","../../../src/framework/auth/components/login/login.component.html","../../../src/framework/auth/components/register/register.component.ts","../../../src/framework/auth/components/register/register.component.html","../../../src/framework/auth/components/logout/logout.component.ts","../../../src/framework/auth/components/logout/logout.component.html","../../../src/framework/auth/components/request-password/request-password.component.ts","../../../src/framework/auth/components/request-password/request-password.component.html","../../../src/framework/auth/components/reset-password/reset-password.component.ts","../../../src/framework/auth/components/reset-password/reset-password.component.html","../../../src/framework/auth/auth.module.ts","../../../src/framework/auth/auth.routes.ts","../../../src/framework/auth/services/interceptors/jwt-interceptor.ts","../../../src/framework/auth/services/interceptors/simple-interceptor.ts","../../../src/framework/auth/models/user.ts","../../../src/framework/auth/public_api.ts","../../../src/framework/auth/nebular-auth.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\nimport { HttpRequest } from '@angular/common/http';\nimport { NbAuthStrategy } from './strategies/auth-strategy';\nimport { NbAuthStrategyOptions } from './strategies/auth-strategy-options';\nimport { NbAuthToken, NbAuthTokenClass } from './services/token/token';\n\nexport type NbAuthStrategyClass = new (...params: any[]) => NbAuthStrategy;\n\nexport type NbAuthStrategies  = [NbAuthStrategyClass, NbAuthStrategyOptions][];\n\nexport interface NbAuthOptions {\n  forms?: any;\n  strategies?: NbAuthStrategies;\n}\n\nexport interface NbAuthSocialLink {\n  link?: string,\n  url?: string,\n  target?: string,\n  title?: string,\n  icon?: string,\n}\n\nconst socialLinks: NbAuthSocialLink[] = [];\n\nexport const defaultAuthOptions: any = {\n  strategies: [],\n  forms: {\n    login: {\n      redirectDelay: 500, // delay before redirect after a successful login, while success message is shown to the user\n      strategy: 'email',  // provider id key. If you have multiple strategies, or what to use your own\n      rememberMe: true,   // whether to show or not the `rememberMe` checkbox\n      showMessages: {     // show/not show success/error messages\n        success: true,\n        error: true,\n      },\n      socialLinks: socialLinks, // social links at the bottom of a page\n    },\n    register: {\n      redirectDelay: 500,\n      strategy: 'email',\n      showMessages: {\n        success: true,\n        error: true,\n      },\n      terms: true,\n      socialLinks: socialLinks,\n    },\n    requestPassword: {\n      redirectDelay: 500,\n      strategy: 'email',\n      showMessages: {\n        success: true,\n        error: true,\n      },\n      socialLinks: socialLinks,\n    },\n    resetPassword: {\n      redirectDelay: 500,\n      strategy: 'email',\n      showMessages: {\n        success: true,\n        error: true,\n      },\n      socialLinks: socialLinks,\n    },\n    logout: {\n      redirectDelay: 500,\n      strategy: 'email',\n    },\n    validation: {\n      password: {\n        required: true,\n        minLength: 4,\n        maxLength: 50,\n      },\n      email: {\n        required: true,\n      },\n      fullName: {\n        required: false,\n        minLength: 4,\n        maxLength: 50,\n      },\n    },\n  },\n};\n\nexport const NB_AUTH_OPTIONS = new InjectionToken<NbAuthOptions>('Nebular Auth Options');\nexport const NB_AUTH_USER_OPTIONS = new InjectionToken<NbAuthOptions>('Nebular User Auth Options');\nexport const NB_AUTH_STRATEGIES = new InjectionToken<NbAuthStrategies>('Nebular Auth Strategies');\nexport const NB_AUTH_TOKENS = new InjectionToken<NbAuthTokenClass<NbAuthToken>[]>('Nebular Auth Tokens');\nexport const NB_AUTH_INTERCEPTOR_HEADER = new InjectionToken<string>('Nebular Simple Interceptor Header');\nexport const NB_AUTH_TOKEN_INTERCEPTOR_FILTER =\n       new InjectionToken<(req: HttpRequest<any>) => boolean>('Nebular Interceptor Filter');\n\n","/**\n * Extending object that entered in first argument.\n *\n * Returns extended object or false if have no target object or incorrect type.\n *\n * If you wish to clone source object (without modify it), just use empty new\n * object as first argument, like this:\n *   deepExtend({}, yourObj_1, [yourObj_N]);\n */\nexport const deepExtend = function (...objects: any[]): any {\n  if (arguments.length < 1 || typeof arguments[0] !== 'object') {\n    return false;\n  }\n\n  if (arguments.length < 2) {\n    return arguments[0];\n  }\n\n  const target = arguments[0];\n\n  // convert arguments to array and cut off target object\n  const args = Array.prototype.slice.call(arguments, 1);\n\n  let val, src;\n\n  args.forEach(function (obj: any) {\n    // skip argument if it is array or isn't object\n    if (typeof obj !== 'object' || Array.isArray(obj)) {\n      return;\n    }\n\n    Object.keys(obj).forEach(function (key) {\n      src = target[key]; // source value\n      val = obj[key]; // new value\n\n      // recursion prevention\n      if (val === target) {\n        return;\n\n        /**\n         * if new value isn't object then just overwrite by new value\n         * instead of extending.\n         */\n      } else if (typeof val !== 'object' || val === null) {\n        target[key] = val;\n\n        return;\n\n        // just clone arrays (and recursive clone objects inside)\n      } else if (Array.isArray(val)) {\n        target[key] = deepCloneArray(val);\n\n        return;\n\n        // custom cloning and overwrite for specific objects\n      } else if (isSpecificValue(val)) {\n        target[key] = cloneSpecificValue(val);\n\n        return;\n\n        // overwrite by new value if source isn't object or array\n      } else if (typeof src !== 'object' || src === null || Array.isArray(src)) {\n        target[key] = deepExtend({}, val);\n\n        return;\n\n        // source value and new value is objects both, extending...\n      } else {\n        target[key] = deepExtend(src, val);\n\n        return;\n      }\n    });\n  });\n\n  return target;\n};\n\nfunction isSpecificValue(val: any) {\n  return (\n    val instanceof Date\n    || val instanceof RegExp\n  ) ? true : false;\n}\n\nfunction cloneSpecificValue(val: any): any {\n  if (val instanceof Date) {\n    return new Date(val.getTime());\n  } else if (val instanceof RegExp) {\n    return new RegExp(val);\n  } else {\n    throw new Error('cloneSpecificValue: Unexpected situation');\n  }\n}\n\n/**\n * Recursive cloning array.\n */\nfunction deepCloneArray(arr: any[]): any {\n  const clone: any[] = [];\n  arr.forEach(function (item: any, index: any) {\n    if (typeof item === 'object' && item !== null) {\n      if (Array.isArray(item)) {\n        clone[index] = deepCloneArray(item);\n      } else if (isSpecificValue(item)) {\n        clone[index] = cloneSpecificValue(item);\n      } else {\n        clone[index] = deepExtend({}, item);\n      }\n    } else {\n      clone[index] = item;\n    }\n  });\n\n  return clone;\n}\n\n// getDeepFromObject({result: {data: 1}}, 'result.data', 2); // returns 1\nexport function getDeepFromObject(object = {}, name: string, defaultValue?: any) {\n  const keys = name.split('.');\n  // clone the object\n  let level = deepExtend({}, object || {});\n  keys.forEach((k) => {\n    if (level && typeof level[k] !== 'undefined') {\n      level = level[k];\n    } else {\n      level = undefined;\n    }\n  });\n\n  return typeof level === 'undefined' ? defaultValue : level;\n}\n\nexport function urlBase64Decode(str: string): string {\n  let output = str.replace(/-/g, '+').replace(/_/g, '/');\n  switch (output.length % 4) {\n    case 0: { break; }\n    case 2: { output += '=='; break; }\n    case 3: { output += '='; break; }\n    default: {\n      throw new Error('Illegal base64url string!');\n    }\n  }\n  return b64DecodeUnicode(output);\n}\n\nexport function b64decode(str: string): string {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  let output: string = '';\n\n  str = String(str).replace(/=+$/, '');\n\n  if (str.length % 4 === 1) {\n    throw new Error(`'atob' failed: The string to be decoded is not correctly encoded.`);\n  }\n\n  for (\n    // initialize result and counters\n    let bc: number = 0, bs: any, buffer: any, idx: number = 0;\n    // get next character\n    buffer = str.charAt(idx++);\n    // character found in table? initialize bit storage and add its ascii value;\n    ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer,\n      // and if not first of each 4 characters,\n      // convert the first 8 bits to one ascii character\n    bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0\n  ) {\n    // try to find character in table (0-63, not found => -1)\n    buffer = chars.indexOf(buffer);\n  }\n  return output;\n}\n\n// https://developer.mozilla.org/en/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#The_Unicode_Problem\nexport function b64DecodeUnicode(str: any) {\n  return decodeURIComponent(Array.prototype.map.call(b64decode(str), (c: any) => {\n    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n  }).join(''));\n}\n","import { urlBase64Decode } from '../../helpers';\n\nexport abstract class NbAuthToken {\n\n  protected payload: any = null;\n\n  abstract getValue(): string;\n  abstract isValid(): boolean;\n  // the strategy name used to acquire this token (needed for refreshing token)\n  abstract getOwnerStrategyName(): string;\n  abstract getCreatedAt(): Date;\n  abstract toString(): string;\n\n  getName(): string {\n    return (this.constructor as NbAuthTokenClass).NAME;\n  }\n\n  getPayload(): any {\n    return this.payload;\n  }\n}\n\nexport class NbAuthTokenNotFoundError extends Error {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n}\n\nexport class NbAuthIllegalTokenError extends Error {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n}\n\nexport class NbAuthEmptyTokenError extends NbAuthIllegalTokenError {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n}\n\nexport class NbAuthIllegalJWTTokenError extends NbAuthIllegalTokenError {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n}\n\nexport interface NbAuthRefreshableToken {\n  getRefreshToken(): string;\n  setRefreshToken(refreshToken: string);\n}\n\nexport interface NbAuthTokenClass<T = NbAuthToken> {\n  NAME: string;\n  new (raw: any, strategyName: string, expDate?: Date): T;\n}\n\nexport function nbAuthCreateToken<T extends NbAuthToken>(tokenClass: NbAuthTokenClass<T>,\n                                  token: any,\n                                  ownerStrategyName: string,\n                                  createdAt?: Date) {\n  return new tokenClass(token, ownerStrategyName, createdAt);\n}\n\nexport function decodeJwtPayload(payload: string): any {\n\n  if (payload.length === 0) {\n    throw new NbAuthEmptyTokenError('Cannot extract from an empty payload.');\n  }\n\n  const parts = payload.split('.');\n\n  if (parts.length !== 3) {\n    throw new NbAuthIllegalJWTTokenError(\n      `The payload ${payload} is not valid JWT payload and must consist of three parts.`);\n  }\n\n  let decoded;\n  try {\n    decoded = urlBase64Decode(parts[1]);\n  } catch (e) {\n    throw new NbAuthIllegalJWTTokenError(\n      `The payload ${payload} is not valid JWT payload and cannot be parsed.`);\n  }\n\n  if (!decoded) {\n    throw new NbAuthIllegalJWTTokenError(\n      `The payload ${payload} is not valid JWT payload and cannot be decoded.`);\n  }\n  return JSON.parse(decoded);\n}\n\n/**\n * Wrapper for simple (text) token\n */\nexport class NbAuthSimpleToken extends NbAuthToken {\n\n  static NAME = 'nb:auth:simple:token';\n\n  constructor(protected readonly token: any,\n              protected readonly ownerStrategyName: string,\n              protected createdAt?: Date) {\n    super();\n    try {\n      this.parsePayload();\n    } catch (err) {\n      if (!(err instanceof NbAuthTokenNotFoundError)) {\n        // token is present but has got a problem, including illegal\n        throw err;\n      }\n    }\n    this.createdAt = this.prepareCreatedAt(createdAt);\n  }\n\n  protected parsePayload(): any {\n    this.payload = null;\n  }\n\n  protected prepareCreatedAt(date: Date) {\n    return date ? date : new Date();\n  }\n\n  /**\n   * Returns the token's creation date\n   * @returns {Date}\n   */\n  getCreatedAt(): Date {\n    return this.createdAt;\n  }\n\n  /**\n   * Returns the token value\n   * @returns string\n   */\n  getValue(): string {\n    return this.token;\n  }\n\n  getOwnerStrategyName(): string {\n    return this.ownerStrategyName;\n  }\n\n  /**\n   * Is non empty and valid\n   * @returns {boolean}\n   */\n  isValid(): boolean {\n    return !!this.getValue();\n  }\n\n  /**\n   * Validate value and convert to string, if value is not valid return empty string\n   * @returns {string}\n   */\n  toString(): string {\n    return !!this.token ? this.token : '';\n  }\n}\n\n/**\n * Wrapper for JWT token with additional methods.\n */\nexport class NbAuthJWTToken extends NbAuthSimpleToken {\n\n  static NAME = 'nb:auth:jwt:token';\n\n  /**\n   * for JWT token, the iat (issued at) field of the token payload contains the creation Date\n   */\n  protected prepareCreatedAt(date: Date) {\n      const decoded = this.getPayload();\n      return decoded && decoded.iat ? new Date(Number(decoded.iat) * 1000) : super.prepareCreatedAt(date);\n  }\n\n  /**\n   * Returns payload object\n   * @returns any\n   */\n  protected parsePayload(): void {\n    if (!this.token) {\n      throw new NbAuthTokenNotFoundError('Token not found. ')\n    }\n    this.payload = decodeJwtPayload(this.token);\n  }\n\n  /**\n   * Returns expiration date\n   * @returns Date\n   */\n  getTokenExpDate(): Date {\n    const decoded = this.getPayload();\n    if (decoded && !decoded.hasOwnProperty('exp')) {\n      return null;\n    }\n    const date = new Date(0);\n    date.setUTCSeconds(decoded.exp); // 'cause jwt token are set in seconds\n    return date;\n  }\n\n  /**\n   * Is data expired\n   * @returns {boolean}\n   */\n  isValid(): boolean {\n    return super.isValid() && (!this.getTokenExpDate() || new Date() < this.getTokenExpDate());\n  }\n}\n\nconst prepareOAuth2Token = (data) => {\n  if (typeof data === 'string') {\n    try {\n      return JSON.parse(data);\n    } catch (e) {}\n  }\n  return data;\n};\n\n/**\n * Wrapper for OAuth2 token whose access_token is a JWT Token\n */\nexport class NbAuthOAuth2Token extends NbAuthSimpleToken {\n\n  static NAME = 'nb:auth:oauth2:token';\n\n  constructor( data: { [key: string]: string|number }|string = {},\n               ownerStrategyName: string,\n               createdAt?: Date) {\n\n    // we may get it as string when retrieving from a storage\n    super(prepareOAuth2Token(data), ownerStrategyName, createdAt);\n  }\n\n  /**\n   * Returns the token value\n   * @returns string\n   */\n  getValue(): string {\n    return this.token.access_token;\n  }\n\n  /**\n   * Returns the refresh token\n   * @returns string\n   */\n  getRefreshToken(): string {\n    return this.token.refresh_token;\n  }\n\n  /**\n   *  put refreshToken in the token payload\n    * @param refreshToken\n   */\n  setRefreshToken(refreshToken: string) {\n    this.token.refresh_token = refreshToken;\n  }\n\n  /**\n   * Parses token payload\n   * @returns any\n   */\n  protected parsePayload(): void {\n    if (!this.token) {\n      throw new NbAuthTokenNotFoundError('Token not found.')\n    } else {\n      if (!Object.keys(this.token).length) {\n        throw new NbAuthEmptyTokenError('Cannot extract payload from an empty token.');\n      }\n    }\n    this.payload = this.token;\n  }\n\n  /**\n   * Returns the token type\n   * @returns string\n   */\n  getType(): string {\n    return this.token.token_type;\n  }\n\n  /**\n   * Is data expired\n   * @returns {boolean}\n   */\n  isValid(): boolean {\n    return super.isValid() && (!this.getTokenExpDate() || new Date() < this.getTokenExpDate());\n  }\n\n  /**\n   * Returns expiration date\n   * @returns Date\n   */\n  getTokenExpDate(): Date {\n    if (!this.token.hasOwnProperty('expires_in')) {\n      return null;\n    }\n    return new Date(this.createdAt.getTime() + Number(this.token.expires_in) * 1000);\n}\n\n  /**\n   * Convert to string\n   * @returns {string}\n   */\n  toString(): string {\n    return JSON.stringify(this.token);\n  }\n}\n\n/**\n * Wrapper for OAuth2 token embedding JWT tokens\n */\nexport class NbAuthOAuth2JWTToken extends NbAuthOAuth2Token {\n\n  static NAME = 'nb:auth:oauth2:jwt:token';\n\n  protected accessTokenPayload: any;\n\n  protected parsePayload(): void {\n    super.parsePayload();\n    this.parseAccessTokenPayload();\n  }\n\n  protected parseAccessTokenPayload(): any {\n    const accessToken = this.getValue();\n    if (!accessToken) {\n      throw new NbAuthTokenNotFoundError('access_token key not found.')\n    }\n    this.accessTokenPayload = decodeJwtPayload(accessToken);\n  }\n\n  /**\n   * Returns access token payload\n   * @returns any\n   */\n  getAccessTokenPayload(): any {\n    return this.accessTokenPayload;\n  }\n\n  /**\n   * for Oauth2 JWT token, the iat (issued at) field of the access_token payload\n   */\n  protected prepareCreatedAt(date: Date) {\n    const payload = this.accessTokenPayload;\n    return payload && payload.iat ? new Date(Number(payload.iat) * 1000) : super.prepareCreatedAt(date);\n  }\n\n  /**\n   * Is token valid\n   * @returns {boolean}\n   */\n  isValid(): boolean {\n    return this.accessTokenPayload && super.isValid();\n  }\n\n  /**\n   * Returns expiration date :\n   * - exp if set,\n   * - super.getExpDate() otherwise\n   * @returns Date\n   */\n  getTokenExpDate(): Date {\n    if (this.accessTokenPayload && this.accessTokenPayload.hasOwnProperty('exp')) {\n      const date = new Date(0);\n      date.setUTCSeconds(this.accessTokenPayload.exp);\n      return date;\n    } else {\n      return super.getTokenExpDate();\n    }\n  }\n}\n","import { Inject, Injectable, InjectionToken } from '@angular/core';\n\nimport { nbAuthCreateToken, NbAuthToken, NbAuthTokenClass } from './token';\nimport { NB_AUTH_TOKENS } from '../../auth.options';\n\nexport interface NbTokenPack {\n  name: string,\n  ownerStrategyName: string,\n  createdAt: Number,\n  value: string,\n}\n\nexport const NB_AUTH_FALLBACK_TOKEN = new InjectionToken<NbAuthTokenClass>('Nebular Auth Options');\n\n/**\n * Creates a token parcel which could be stored/restored\n */\n@Injectable()\nexport class NbAuthTokenParceler {\n\n  constructor(@Inject(NB_AUTH_FALLBACK_TOKEN) private fallbackClass: NbAuthTokenClass,\n              @Inject(NB_AUTH_TOKENS) private tokenClasses: NbAuthTokenClass[]) {\n  }\n\n  wrap(token: NbAuthToken): string {\n    return JSON.stringify({\n      name: token.getName(),\n      ownerStrategyName: token.getOwnerStrategyName(),\n      createdAt: token.getCreatedAt().getTime(),\n      value: token.toString(),\n    });\n  }\n\n  unwrap(value: string): NbAuthToken {\n    let tokenClass: NbAuthTokenClass = this.fallbackClass;\n    let tokenValue = '';\n    let tokenOwnerStrategyName = '';\n    let tokenCreatedAt: Date = null;\n\n    const tokenPack: NbTokenPack = this.parseTokenPack(value);\n    if (tokenPack) {\n      tokenClass = this.getClassByName(tokenPack.name) || this.fallbackClass;\n      tokenValue = tokenPack.value;\n      tokenOwnerStrategyName = tokenPack.ownerStrategyName;\n      tokenCreatedAt = new Date(Number(tokenPack.createdAt));\n    }\n\n    return nbAuthCreateToken(tokenClass, tokenValue, tokenOwnerStrategyName, tokenCreatedAt);\n\n  }\n\n  // TODO: this could be moved to a separate token registry\n  protected getClassByName(name): NbAuthTokenClass {\n    return this.tokenClasses.find((tokenClass: NbAuthTokenClass) => tokenClass.NAME === name);\n  }\n\n  protected parseTokenPack(value): NbTokenPack {\n    try {\n      return JSON.parse(value);\n    } catch (e) { }\n    return null;\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { NbAuthToken } from './token';\nimport { NbAuthTokenParceler } from './token-parceler';\n\nexport abstract class NbTokenStorage {\n\n  abstract get(): NbAuthToken;\n  abstract set(token: NbAuthToken);\n  abstract clear();\n}\n\n/**\n * Service that uses browser localStorage as a storage.\n *\n * The token storage is provided into auth module the following way:\n * ```ts\n * { provide: NbTokenStorage, useClass: NbTokenLocalStorage },\n * ```\n *\n * If you need to change the storage behaviour or provide your own - just extend your class from basic `NbTokenStorage`\n * or `NbTokenLocalStorage` and provide in your `app.module`:\n * ```ts\n * { provide: NbTokenStorage, useClass: NbTokenCustomStorage },\n * ```\n *\n */\n@Injectable()\nexport class NbTokenLocalStorage extends NbTokenStorage {\n\n  protected key = 'auth_app_token';\n\n  constructor(private parceler: NbAuthTokenParceler) {\n    super();\n  }\n\n  /**\n   * Returns token from localStorage\n   * @returns {NbAuthToken}\n   */\n  get(): NbAuthToken {\n    const raw = localStorage.getItem(this.key);\n    return this.parceler.unwrap(raw);\n  }\n\n  /**\n   * Sets token to localStorage\n   * @param {NbAuthToken} token\n   */\n  set(token: NbAuthToken) {\n    const raw = this.parceler.wrap(token);\n    localStorage.setItem(this.key, raw);\n  }\n\n  /**\n   * Clears token from localStorage\n   */\n  clear() {\n    localStorage.removeItem(this.key);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, BehaviorSubject, of as observableOf } from 'rxjs';\nimport { filter, share } from 'rxjs/operators';\n\nimport { NbTokenStorage } from './token-storage';\nimport { NbAuthToken } from './token';\n\n/**\n * Service that allows you to manage authentication token - get, set, clear and also listen to token changes over time.\n */\n@Injectable()\nexport class NbTokenService {\n\n  protected token$: BehaviorSubject<NbAuthToken> = new BehaviorSubject(null);\n\n  constructor(protected tokenStorage: NbTokenStorage) {\n    this.publishStoredToken();\n  }\n\n  /**\n   * Publishes token when it changes.\n   * @returns {Observable<NbAuthToken>}\n   */\n  tokenChange(): Observable<NbAuthToken> {\n    return this.token$\n      .pipe(\n        filter(value => !!value),\n        share(),\n      );\n  }\n\n  /**\n   * Sets a token into the storage. This method is used by the NbAuthService automatically.\n   *\n   * @param {NbAuthToken} token\n   * @returns {Observable<any>}\n   */\n  set(token: NbAuthToken): Observable<null> {\n    this.tokenStorage.set(token);\n    this.publishStoredToken();\n    return observableOf(null);\n  }\n\n  /**\n   * Returns observable of current token\n   * @returns {Observable<NbAuthToken>}\n   */\n  get(): Observable<NbAuthToken> {\n    const token = this.tokenStorage.get();\n    return observableOf(token);\n  }\n\n  /**\n   * Removes the token and published token value\n   *\n   * @returns {Observable<any>}\n   */\n  clear(): Observable<null> {\n    this.tokenStorage.clear();\n    this.publishStoredToken();\n    return observableOf(null);\n  }\n\n  protected publishStoredToken() {\n    this.token$.next(this.tokenStorage.get());\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { Inject, Injectable } from '@angular/core';\n\nimport { Observable, of as observableOf } from 'rxjs';\nimport { switchMap, map } from 'rxjs/operators';\n\nimport { NbAuthStrategy } from '../strategies/auth-strategy';\nimport { NB_AUTH_STRATEGIES } from '../auth.options';\nimport { NbAuthResult } from './auth-result';\nimport { NbTokenService } from './token/token.service';\nimport { NbAuthToken } from './token/token';\n\n/**\n * Common authentication service.\n * Should be used to as an interlayer between UI Components and Auth Strategy.\n */\n@Injectable()\nexport class NbAuthService {\n\n  constructor(protected tokenService: NbTokenService,\n              @Inject(NB_AUTH_STRATEGIES) protected strategies) {\n  }\n\n  /**\n   * Retrieves current authenticated token stored\n   * @returns {Observable<any>}\n   */\n  getToken(): Observable<NbAuthToken> {\n    return this.tokenService.get();\n  }\n\n  /**\n   * Returns true if auth token is present in the token storage\n   * @returns {Observable<boolean>}\n   */\n  isAuthenticated(): Observable<boolean> {\n    return this.getToken()\n      .pipe(map((token: NbAuthToken) => token.isValid()));\n  }\n\n  /**\n   * Returns true if valid auth token is present in the token storage.\n   * If not, calls the strategy refreshToken, and returns isAuthenticated() if success, false otherwise\n   * @returns {Observable<boolean>}\n   */\n  isAuthenticatedOrRefresh(): Observable<boolean> {\n    return this.getToken()\n      .pipe(\n        switchMap(token => {\n        if (token.getValue() && !token.isValid()) {\n          return this.refreshToken(token.getOwnerStrategyName(), token)\n            .pipe(\n              switchMap(res => {\n                if (res.isSuccess()) {\n                  return this.isAuthenticated();\n                } else {\n                  return observableOf(false);\n                }\n              }),\n            )\n        } else {\n          return observableOf(token.isValid());\n        }\n    }));\n  }\n\n  /**\n   * Returns tokens stream\n   * @returns {Observable<NbAuthSimpleToken>}\n   */\n  onTokenChange(): Observable<NbAuthToken> {\n    return this.tokenService.tokenChange();\n  }\n\n  /**\n   * Returns authentication status stream\n   * @returns {Observable<boolean>}\n   */\n  onAuthenticationChange(): Observable<boolean> {\n    return this.onTokenChange()\n      .pipe(map((token: NbAuthToken) => token.isValid()));\n  }\n\n  /**\n   * Authenticates with the selected strategy\n   * Stores received token in the token storage\n   *\n   * Example:\n   * authenticate('email', {email: 'email@example.com', password: 'test'})\n   *\n   * @param strategyName\n   * @param data\n   * @returns {Observable<NbAuthResult>}\n   */\n  authenticate(strategyName: string, data?: any): Observable<NbAuthResult> {\n    return this.getStrategy(strategyName).authenticate(data)\n      .pipe(\n        switchMap((result: NbAuthResult) => {\n          return this.processResultToken(result);\n        }),\n      );\n  }\n\n  /**\n   * Registers with the selected strategy\n   * Stores received token in the token storage\n   *\n   * Example:\n   * register('email', {email: 'email@example.com', name: 'Some Name', password: 'test'})\n   *\n   * @param strategyName\n   * @param data\n   * @returns {Observable<NbAuthResult>}\n   */\n  register(strategyName: string, data?: any): Observable<NbAuthResult> {\n    return this.getStrategy(strategyName).register(data)\n      .pipe(\n        switchMap((result: NbAuthResult) => {\n          return this.processResultToken(result);\n        }),\n      );\n  }\n\n  /**\n   * Sign outs with the selected strategy\n   * Removes token from the token storage\n   *\n   * Example:\n   * logout('email')\n   *\n   * @param strategyName\n   * @returns {Observable<NbAuthResult>}\n   */\n  logout(strategyName: string): Observable<NbAuthResult> {\n    return this.getStrategy(strategyName).logout()\n      .pipe(\n        switchMap((result: NbAuthResult) => {\n          if (result.isSuccess()) {\n            this.tokenService.clear()\n              .pipe(map(() => result));\n          }\n          return observableOf(result);\n        }),\n      );\n  }\n\n  /**\n   * Sends forgot password request to the selected strategy\n   *\n   * Example:\n   * requestPassword('email', {email: 'email@example.com'})\n   *\n   * @param strategyName\n   * @param data\n   * @returns {Observable<NbAuthResult>}\n   */\n  requestPassword(strategyName: string, data?: any): Observable<NbAuthResult> {\n    return this.getStrategy(strategyName).requestPassword(data);\n  }\n\n  /**\n   * Tries to reset password with the selected strategy\n   *\n   * Example:\n   * resetPassword('email', {newPassword: 'test'})\n   *\n   * @param strategyName\n   * @param data\n   * @returns {Observable<NbAuthResult>}\n   */\n  resetPassword(strategyName: string, data?: any): Observable<NbAuthResult> {\n    return this.getStrategy(strategyName).resetPassword(data);\n  }\n\n  /**\n   * Sends a refresh token request\n   * Stores received token in the token storage\n   *\n   * Example:\n   * refreshToken('email', {token: token})\n   *\n   * @param {string} strategyName\n   * @param data\n   * @returns {Observable<NbAuthResult>}\n   */\n  refreshToken(strategyName: string, data?: any): Observable<NbAuthResult> {\n    return this.getStrategy(strategyName).refreshToken(data)\n      .pipe(\n        switchMap((result: NbAuthResult) => {\n          return this.processResultToken(result);\n        }),\n      );\n  }\n\n  /**\n   * Get registered strategy by name\n   *\n   * Example:\n   * getStrategy('email')\n   *\n   * @param {string} provider\n   * @returns {NbAbstractAuthProvider}\n   */\n  protected getStrategy(strategyName: string): NbAuthStrategy {\n    const found = this.strategies.find((strategy: NbAuthStrategy) => strategy.getName() === strategyName);\n\n    if (!found) {\n      throw new TypeError(`There is no Auth Strategy registered under '${strategyName}' name`);\n    }\n\n    return found;\n  }\n\n  private processResultToken(result: NbAuthResult) {\n    if (result.isSuccess() && result.getToken()) {\n      return this.tokenService.set(result.getToken())\n        .pipe(\n          map((token: NbAuthToken) => {\n            return result;\n          }),\n        );\n    }\n\n    return observableOf(result);\n  }\n}\n","import { HttpHeaders, HttpResponse } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { NbAuthResult } from '../services/auth-result';\nimport { NbAuthStrategyOptions } from './auth-strategy-options';\nimport { deepExtend, getDeepFromObject } from '../helpers';\nimport { NbAuthToken, nbAuthCreateToken, NbAuthIllegalTokenError } from '../services/token/token';\n\nexport abstract class NbAuthStrategy {\n  protected defaultOptions: NbAuthStrategyOptions;\n  protected options: NbAuthStrategyOptions;\n\n  // we should keep this any and validation should be done in `register` method instead\n  // otherwise it won't be possible to pass an empty object\n  setOptions(options: any): void {\n    this.options = deepExtend({}, this.defaultOptions, options);\n  }\n\n  getOption(key: string): any {\n    return getDeepFromObject(this.options, key, null);\n  }\n\n  createToken<T extends NbAuthToken>(value: any, failWhenInvalidToken?: boolean): T {\n    const token = nbAuthCreateToken<T>(this.getOption('token.class'), value, this.getName());\n    // At this point, nbAuthCreateToken failed with NbAuthIllegalTokenError which MUST be intercepted by strategies\n    // Or token is created. It MAY be created even if backend did not return any token, in this case it is !Valid\n    if (failWhenInvalidToken && !token.isValid()) {\n      // If we require a valid token (i.e. isValid), then we MUST throw NbAuthIllegalTokenError so that the strategies\n      // intercept it\n      throw new NbAuthIllegalTokenError('Token is empty or invalid.');\n    }\n    return token;\n  }\n\n  getName(): string {\n    return this.getOption('name');\n  }\n\n  abstract authenticate(data?: any): Observable<NbAuthResult>;\n\n  abstract register(data?: any): Observable<NbAuthResult>;\n\n  abstract requestPassword(data?: any): Observable<NbAuthResult>;\n\n  abstract resetPassword(data?: any): Observable<NbAuthResult>;\n\n  abstract logout(): Observable<NbAuthResult>;\n\n  abstract refreshToken(data?: any): Observable<NbAuthResult>;\n\n  protected createFailResponse(data?: any): HttpResponse<Object> {\n    return new HttpResponse<Object>({ body: {}, status: 401 });\n  }\n\n  protected createSuccessResponse(data?: any): HttpResponse<Object> {\n    return new HttpResponse<Object>({ body: {}, status: 200 });\n  }\n\n  protected getActionEndpoint(action: string): string {\n    const actionEndpoint: string = this.getOption(`${action}.endpoint`);\n    const baseEndpoint: string = this.getOption('baseEndpoint');\n    return actionEndpoint ? baseEndpoint + actionEndpoint : '';\n  }\n\n  protected getHeaders(): HttpHeaders {\n    const customHeaders: NbAuthStrategyOptions['headers'] = this.getOption('headers') ?? {};\n    if (customHeaders instanceof HttpHeaders) {\n      return customHeaders;\n    }\n\n    let headers = new HttpHeaders();\n    Object.entries(customHeaders).forEach(([key, value]) => {\n      headers = headers.append(key, value);\n    });\n    return headers;\n  }\n}\n","import { NbAuthToken } from './token/token';\n\nexport class NbAuthResult {\n\n  protected token: NbAuthToken;\n  protected errors: string[] = [];\n  protected messages: string[] = [];\n\n  // TODO: better pass object\n  constructor(protected success: boolean,\n              protected response?: any,\n              protected redirect?: any,\n              errors?: any,\n              messages?: any,\n              token: NbAuthToken = null) {\n\n    this.errors = this.errors.concat([errors]);\n    if (errors instanceof Array) {\n      this.errors = errors;\n    }\n\n    this.messages = this.messages.concat([messages]);\n    if (messages instanceof Array) {\n      this.messages = messages;\n    }\n\n    this.token = token;\n  }\n\n  getResponse(): any {\n    return this.response;\n  }\n\n  getToken(): NbAuthToken {\n    return this.token;\n  }\n\n  getRedirect(): string {\n    return this.redirect;\n  }\n\n  getErrors(): string[] {\n    return this.errors.filter(val => !!val);\n  }\n\n  getMessages(): string[] {\n    return this.messages.filter(val => !!val);\n  }\n\n  isSuccess(): boolean {\n    return this.success;\n  }\n\n  isFailure(): boolean {\n    return !this.success;\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { HttpHeaders } from '@angular/common/http';\nimport { NbAuthTokenClass } from '../services/token/token';\n\nexport interface NbStrategyToken {\n  class?: NbAuthTokenClass;\n  [key: string]: any;\n}\n\nexport class NbAuthStrategyOptions {\n  name: string;\n  token?: NbStrategyToken;\n  headers?: HttpHeaders | { [header: string]: string | string[]; };\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { NbAuthStrategyOptions, NbStrategyToken } from '../auth-strategy-options';\nimport { NbAuthSimpleToken } from '../../services/token/token';\n\nexport class NbDummyAuthStrategyOptions extends NbAuthStrategyOptions {\n  token?: NbStrategyToken = {\n    class: NbAuthSimpleToken,\n  };\n  delay?: number = 1000;\n  alwaysFail?: boolean = false;\n}\n\nexport const dummyStrategyOptions: NbDummyAuthStrategyOptions = new NbDummyAuthStrategyOptions();\n","import { Injectable } from '@angular/core';\n\nimport { Observable, of as observableOf } from 'rxjs';\nimport { delay } from 'rxjs/operators';\n\nimport { NbAuthStrategy } from '../auth-strategy';\nimport { NbAuthResult } from '../../services/auth-result';\nimport { NbDummyAuthStrategyOptions, dummyStrategyOptions } from './dummy-strategy-options';\nimport { NbAuthStrategyClass } from '../../auth.options';\n\n/**\n * Dummy auth strategy. Could be useful for auth setup when backend is not available yet.\n *\n *\n * Strategy settings.\n *\n * ```ts\n * export class NbDummyAuthStrategyOptions extends NbAuthStrategyOptions {\n *   name = 'dummy';\n *   token = {\n *     class: NbAuthSimpleToken,\n *   };\n *   delay? = 1000;\n *   alwaysFail? = false;\n * }\n * ```\n */\n@Injectable()\nexport class NbDummyAuthStrategy extends NbAuthStrategy {\n  protected defaultOptions: NbDummyAuthStrategyOptions = dummyStrategyOptions;\n\n  static setup(options: NbDummyAuthStrategyOptions): [NbAuthStrategyClass, NbDummyAuthStrategyOptions] {\n    return [NbDummyAuthStrategy, options];\n  }\n\n  authenticate(data?: any): Observable<NbAuthResult> {\n    return observableOf(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  register(data?: any): Observable<NbAuthResult> {\n    return observableOf(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  requestPassword(data?: any): Observable<NbAuthResult> {\n    return observableOf(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  resetPassword(data?: any): Observable<NbAuthResult> {\n    return observableOf(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  logout(data?: any): Observable<NbAuthResult> {\n    return observableOf(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  refreshToken(data?: any): Observable<NbAuthResult> {\n    return observableOf(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  protected createDummyResult(data?: any): NbAuthResult {\n    if (this.getOption('alwaysFail')) {\n      return new NbAuthResult(false, this.createFailResponse(data), null, ['Something went wrong.']);\n    }\n\n    try {\n      const token = this.createToken('test token', true);\n      return new NbAuthResult(true, this.createSuccessResponse(data), '/', [], ['Successfully logged in.'], token);\n    } catch (err) {\n      return new NbAuthResult(false, this.createFailResponse(data), null, [(err as Error).message]);\n    }\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nimport { NbAuthOAuth2Token, NbAuthTokenClass } from '../../services/token/token';\nimport { NbAuthStrategyOptions } from '../auth-strategy-options';\n\nexport enum NbOAuth2ResponseType {\n  CODE = 'code',\n  TOKEN = 'token',\n}\n\n// TODO: client_credentials\nexport enum NbOAuth2GrantType {\n  AUTHORIZATION_CODE = 'authorization_code',\n  PASSWORD = 'password',\n  REFRESH_TOKEN = 'refresh_token',\n}\n\nexport enum NbOAuth2ClientAuthMethod {\n  NONE = 'none',\n  BASIC = 'basic',\n  REQUEST_BODY = 'request-body',\n}\n\nexport class NbOAuth2AuthStrategyOptions extends NbAuthStrategyOptions {\n  baseEndpoint?: string = '';\n  clientId: string = '';\n  clientSecret?: string = '';\n  clientAuthMethod?: string = NbOAuth2ClientAuthMethod.NONE;\n  redirect?: { success?: string; failure?: string } = {\n    success: '/',\n    failure: null,\n  };\n  defaultErrors?: any[] = ['Something went wrong, please try again.'];\n  defaultMessages?: any[] = ['You have been successfully authenticated.'];\n  authorize?: {\n    endpoint?: string;\n    redirectUri?: string;\n    responseType?: string;\n    requireValidToken?: boolean; // used only with NbOAuth2ResponseType.TOKEN\n    scope?: string;\n    state?: string;\n    params?: { [key: string]: string };\n  } = {\n    endpoint: 'authorize',\n    responseType: NbOAuth2ResponseType.CODE,\n    requireValidToken: true,\n  };\n  token?: {\n    endpoint?: string;\n    grantType?: string;\n    redirectUri?: string;\n    scope?: string; // Used only with 'password' grantType\n    requireValidToken?: boolean;\n    class: NbAuthTokenClass,\n  } = {\n    endpoint: 'token',\n    grantType: NbOAuth2GrantType.AUTHORIZATION_CODE,\n    requireValidToken: true,\n    class: NbAuthOAuth2Token,\n  };\n  refresh?: {\n    endpoint?: string;\n    grantType?: string;\n    scope?: string;\n    requireValidToken?: boolean;\n  } = {\n    endpoint: 'token',\n    grantType: NbOAuth2GrantType.REFRESH_TOKEN,\n    requireValidToken: true,\n  };\n}\n\nexport const auth2StrategyOptions: NbOAuth2AuthStrategyOptions = new NbOAuth2AuthStrategyOptions();\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { Inject, Injectable } from '@angular/core';\nimport { HttpClient, HttpErrorResponse, HttpHeaders } from '@angular/common/http';\nimport { ActivatedRoute } from '@angular/router';\nimport { Observable, of as observableOf } from 'rxjs';\nimport { switchMap, map, catchError } from 'rxjs/operators';\nimport { NB_WINDOW } from '@nebular/theme';\n\nimport { NbAuthStrategy } from '../auth-strategy';\nimport { NbAuthIllegalTokenError, NbAuthRefreshableToken, NbAuthToken } from '../../services/token/token';\nimport { NbAuthResult } from '../../services/auth-result';\nimport {\n  NbOAuth2AuthStrategyOptions,\n  NbOAuth2ResponseType,\n  auth2StrategyOptions,\n  NbOAuth2GrantType,\n  NbOAuth2ClientAuthMethod,\n} from './oauth2-strategy.options';\nimport { NbAuthStrategyClass } from '../../auth.options';\n\n/**\n * OAuth2 authentication strategy.\n *\n * Strategy settings:\n *\n * ```ts\n * export enum NbOAuth2ResponseType {\n *   CODE = 'code',\n *   TOKEN = 'token',\n * }\n *\n * export enum NbOAuth2GrantType {\n *   AUTHORIZATION_CODE = 'authorization_code',\n *   PASSWORD = 'password',\n *   REFRESH_TOKEN = 'refresh_token',\n * }\n *\n * export class NbOAuth2AuthStrategyOptions {\n *   name: string;\n *   baseEndpoint?: string = '';\n *   clientId: string = '';\n *   clientSecret: string = '';\n *   clientAuthMethod: string = NbOAuth2ClientAuthMethod.NONE;\n *   redirect?: { success?: string; failure?: string } = {\n *     success: '/',\n *     failure: null,\n *   };\n *   defaultErrors?: any[] = ['Something went wrong, please try again.'];\n *   defaultMessages?: any[] = ['You have been successfully authenticated.'];\n *   authorize?: {\n *     endpoint?: string;\n *     redirectUri?: string;\n *     responseType?: string;\n *     requireValidToken: true,\n *     scope?: string;\n *     state?: string;\n *     params?: { [key: string]: string };\n *   } = {\n *     endpoint: 'authorize',\n *     responseType: NbOAuth2ResponseType.CODE,\n *   };\n *   token?: {\n *     endpoint?: string;\n *     grantType?: string;\n *     requireValidToken: true,\n *     redirectUri?: string;\n *     scope?: string;\n *     class: NbAuthTokenClass,\n *   } = {\n *     endpoint: 'token',\n *     grantType: NbOAuth2GrantType.AUTHORIZATION_CODE,\n *     class: NbAuthOAuth2Token,\n *   };\n *   refresh?: {\n *     endpoint?: string;\n *     grantType?: string;\n *     scope?: string;\n *     requireValidToken: true,\n *   } = {\n *     endpoint: 'token',\n *     grantType: NbOAuth2GrantType.REFRESH_TOKEN,\n *   };\n * }\n * ```\n *\n */\n@Injectable()\nexport class NbOAuth2AuthStrategy extends NbAuthStrategy {\n  static setup(options: NbOAuth2AuthStrategyOptions): [NbAuthStrategyClass, NbOAuth2AuthStrategyOptions] {\n    return [NbOAuth2AuthStrategy, options];\n  }\n\n  get responseType() {\n    return this.getOption('authorize.responseType');\n  }\n\n  get clientAuthMethod() {\n    return this.getOption('clientAuthMethod');\n  }\n\n  protected redirectResultHandlers: { [key: string]: Function } = {\n    [NbOAuth2ResponseType.CODE]: () => {\n      return observableOf(this.route.snapshot.queryParams).pipe(\n        switchMap((params: any) => {\n          if (params.code) {\n            return this.requestToken(params.code);\n          }\n\n          return observableOf(\n            new NbAuthResult(false, params, this.getOption('redirect.failure'), this.getOption('defaultErrors'), []),\n          );\n        }),\n      );\n    },\n    [NbOAuth2ResponseType.TOKEN]: () => {\n      const module = 'authorize';\n      const requireValidToken = this.getOption(`${module}.requireValidToken`);\n      return observableOf(this.route.snapshot.fragment).pipe(\n        map((fragment) => this.parseHashAsQueryParams(fragment)),\n        map((params: any) => {\n          if (!params.error) {\n            return new NbAuthResult(\n              true,\n              params,\n              this.getOption('redirect.success'),\n              [],\n              this.getOption('defaultMessages'),\n              this.createToken(params, requireValidToken),\n            );\n          }\n          return new NbAuthResult(\n            false,\n            params,\n            this.getOption('redirect.failure'),\n            this.getOption('defaultErrors'),\n            [],\n          );\n        }),\n        catchError((err) => {\n          const errors = [];\n          if (err instanceof NbAuthIllegalTokenError) {\n            errors.push(err.message);\n          } else {\n            errors.push('Something went wrong.');\n          }\n          return observableOf(new NbAuthResult(false, err, this.getOption('redirect.failure'), errors));\n        }),\n      );\n    },\n  };\n\n  protected redirectResults: { [key: string]: Function } = {\n    [NbOAuth2ResponseType.CODE]: () => {\n      return observableOf(this.route.snapshot.queryParams).pipe(\n        map((params: any) => !!(params && (params.code || params.error))),\n      );\n    },\n    [NbOAuth2ResponseType.TOKEN]: () => {\n      return observableOf(this.route.snapshot.fragment).pipe(\n        map((fragment) => this.parseHashAsQueryParams(fragment)),\n        map((params: any) => !!(params && (params.access_token || params.error))),\n      );\n    },\n  };\n\n  protected defaultOptions: NbOAuth2AuthStrategyOptions = auth2StrategyOptions;\n\n  constructor(protected http: HttpClient, protected route: ActivatedRoute, @Inject(NB_WINDOW) protected window: any) {\n    super();\n  }\n\n  authenticate(data?: any): Observable<NbAuthResult> {\n    if (this.getOption('token.grantType') === NbOAuth2GrantType.PASSWORD) {\n      return this.passwordToken(data.email, data.password);\n    } else {\n      return this.isRedirectResult().pipe(\n        switchMap((result: boolean) => {\n          if (!result) {\n            this.authorizeRedirect();\n            return observableOf(new NbAuthResult(true));\n          }\n          return this.getAuthorizationResult();\n        }),\n      );\n    }\n  }\n\n  getAuthorizationResult(): Observable<any> {\n    const redirectResultHandler = this.redirectResultHandlers[this.responseType];\n    if (redirectResultHandler) {\n      return redirectResultHandler.call(this);\n    }\n\n    throw new Error(`'${this.responseType}' responseType is not supported,\n                      only 'token' and 'code' are supported now`);\n  }\n\n  refreshToken(token: NbAuthRefreshableToken): Observable<NbAuthResult> {\n    const module = 'refresh';\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n\n    return this.http.post(url, this.buildRefreshRequestData(token), { headers: this.getHeaders() }).pipe(\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption('redirect.success'),\n          [],\n          this.getOption('defaultMessages'),\n          this.createRefreshedToken(res, token, requireValidToken),\n        );\n      }),\n      catchError((res) => this.handleResponseError(res)),\n    );\n  }\n\n  passwordToken(username: string, password: string): Observable<NbAuthResult> {\n    const module = 'token';\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n\n    return this.http.post(url, this.buildPasswordRequestData(username, password), { headers: this.getHeaders() }).pipe(\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption('redirect.success'),\n          [],\n          this.getOption('defaultMessages'),\n          this.createToken(res, requireValidToken),\n        );\n      }),\n      catchError((res) => this.handleResponseError(res)),\n    );\n  }\n\n  protected authorizeRedirect() {\n    this.window.location.href = this.buildRedirectUrl();\n  }\n\n  protected isRedirectResult(): Observable<boolean> {\n    return this.redirectResults[this.responseType].call(this);\n  }\n\n  protected requestToken(code: string) {\n    const module = 'token';\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n\n    return this.http.post(url, this.buildCodeRequestData(code), { headers: this.getHeaders() }).pipe(\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption('redirect.success'),\n          [],\n          this.getOption('defaultMessages'),\n          this.createToken(res, requireValidToken),\n        );\n      }),\n      catchError((res) => this.handleResponseError(res)),\n    );\n  }\n\n  protected buildCodeRequestData(code: string): any {\n    const params = {\n      grant_type: this.getOption('token.grantType'),\n      code: code,\n      redirect_uri: this.getOption('token.redirectUri'),\n      client_id: this.getOption('clientId'),\n    };\n    return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)));\n  }\n\n  protected buildRefreshRequestData(token: NbAuthRefreshableToken): any {\n    const params = {\n      grant_type: this.getOption('refresh.grantType'),\n      refresh_token: token.getRefreshToken(),\n      scope: this.getOption('refresh.scope'),\n      client_id: this.getOption('clientId'),\n    };\n    return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)));\n  }\n\n  protected buildPasswordRequestData(username: string, password: string): string {\n    const params = {\n      grant_type: this.getOption('token.grantType'),\n      username: username,\n      password: password,\n      scope: this.getOption('token.scope'),\n    };\n    return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)));\n  }\n\n  protected buildAuthHeader(): HttpHeaders | undefined {\n    if (this.clientAuthMethod === NbOAuth2ClientAuthMethod.BASIC) {\n      if (this.getOption('clientId') && this.getOption('clientSecret')) {\n        return new HttpHeaders({\n          Authorization: 'Basic ' + btoa(this.getOption('clientId') + ':' + this.getOption('clientSecret')),\n        });\n      } else {\n        throw Error('For basic client authentication method, please provide both clientId & clientSecret.');\n      }\n    }\n    return undefined;\n  }\n\n  protected getHeaders(): HttpHeaders {\n    let headers = super.getHeaders();\n    headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\n\n    const authHeaders = this.buildAuthHeader();\n    if (authHeaders === undefined) {\n      return headers;\n    }\n\n    for (const headerKey of authHeaders.keys()) {\n      for (const headerValue of authHeaders.getAll(headerKey)) {\n        headers = headers.append(headerKey, headerValue);\n      }\n    }\n\n    return headers;\n  }\n\n  protected cleanParams(params: any): any {\n    Object.entries(params).forEach(([key, val]) => !val && delete params[key]);\n    return params;\n  }\n\n  protected addCredentialsToParams(params: any): any {\n    if (this.clientAuthMethod === NbOAuth2ClientAuthMethod.REQUEST_BODY) {\n      if (this.getOption('clientId') && this.getOption('clientSecret')) {\n        return {\n          ...params,\n          client_id: this.getOption('clientId'),\n          client_secret: this.getOption('clientSecret'),\n        };\n      } else {\n        throw Error('For request body client authentication method, please provide both clientId & clientSecret.');\n      }\n    }\n    return params;\n  }\n\n  protected handleResponseError(res: any): Observable<NbAuthResult> {\n    let errors = [];\n    if (res instanceof HttpErrorResponse) {\n      if (res.error.error_description) {\n        errors.push(res.error.error_description);\n      } else {\n        errors = this.getOption('defaultErrors');\n      }\n    } else if (res instanceof NbAuthIllegalTokenError) {\n      errors.push(res.message);\n    } else {\n      errors.push('Something went wrong.');\n    }\n\n    return observableOf(new NbAuthResult(false, res, this.getOption('redirect.failure'), errors, []));\n  }\n\n  protected buildRedirectUrl() {\n    const params = {\n      response_type: this.getOption('authorize.responseType'),\n      client_id: this.getOption('clientId'),\n      redirect_uri: this.getOption('authorize.redirectUri'),\n      scope: this.getOption('authorize.scope'),\n      state: this.getOption('authorize.state'),\n\n      ...this.getOption('authorize.params'),\n    };\n\n    const endpoint = this.getActionEndpoint('authorize');\n    const query = this.urlEncodeParameters(this.cleanParams(params));\n\n    return `${endpoint}?${query}`;\n  }\n\n  protected parseHashAsQueryParams(hash: string): { [key: string]: string } {\n    return hash\n      ? hash.split('&').reduce((acc: any, part: string) => {\n          const item = part.split('=');\n          acc[item[0]] = decodeURIComponent(item[1]);\n          return acc;\n        }, {})\n      : {};\n  }\n\n  protected urlEncodeParameters(params: any): string {\n    return Object.keys(params)\n      .map((k) => {\n        return `${encodeURIComponent(k)}=${encodeURIComponent(params[k])}`;\n      })\n      .join('&');\n  }\n\n  protected createRefreshedToken(res, existingToken: NbAuthRefreshableToken, requireValidToken: boolean): NbAuthToken {\n    type AuthRefreshToken = NbAuthRefreshableToken & NbAuthToken;\n\n    const refreshedToken: AuthRefreshToken = this.createToken<AuthRefreshToken>(res, requireValidToken);\n    if (!refreshedToken.getRefreshToken() && existingToken.getRefreshToken()) {\n      refreshedToken.setRefreshToken(existingToken.getRefreshToken());\n    }\n    return refreshedToken;\n  }\n\n  register(data?: any): Observable<NbAuthResult> {\n    throw new Error('`register` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.');\n  }\n\n  requestPassword(data?: any): Observable<NbAuthResult> {\n    throw new Error('`requestPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.');\n  }\n\n  resetPassword(data: any = {}): Observable<NbAuthResult> {\n    throw new Error('`resetPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.');\n  }\n\n  logout(): Observable<NbAuthResult> {\n    return observableOf(new NbAuthResult(true));\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nimport { NbAuthSimpleToken, NbAuthTokenClass } from '../../services/token/token';\nimport { NbAuthStrategyOptions } from '../auth-strategy-options';\nimport { getDeepFromObject } from '../../helpers';\nimport { HttpErrorResponse, HttpResponse } from '@angular/common/http';\n\nexport interface NbPasswordStrategyModule {\n  alwaysFail?: boolean;\n  endpoint?: string;\n  method?: string;\n  redirect?: {\n    success?: string | null;\n    failure?: string | null;\n  };\n  requireValidToken?: boolean;\n  defaultErrors?: string[];\n  defaultMessages?: string[];\n}\n\nexport interface NbPasswordStrategyReset extends NbPasswordStrategyModule {\n  resetPasswordTokenKey?: string;\n}\n\nexport interface NbPasswordStrategyToken {\n  class?: NbAuthTokenClass,\n  key?: string,\n  getter?: Function,\n}\n\nexport interface NbPasswordStrategyMessage {\n  key?: string,\n  getter?: Function,\n}\n\nexport class NbPasswordAuthStrategyOptions extends NbAuthStrategyOptions {\n  baseEndpoint?: string = '/api/auth/';\n  login?: boolean | NbPasswordStrategyModule = {\n    alwaysFail: false,\n    endpoint: 'login',\n    method: 'post',\n    requireValidToken: true,\n    redirect: {\n      success: '/',\n      failure: null,\n    },\n    defaultErrors: ['Login/Email combination is not correct, please try again.'],\n    defaultMessages: ['You have been successfully logged in.'],\n  };\n  register?: boolean | NbPasswordStrategyModule = {\n    alwaysFail: false,\n    endpoint: 'register',\n    method: 'post',\n    requireValidToken: true,\n    redirect: {\n      success: '/',\n      failure: null,\n    },\n    defaultErrors: ['Something went wrong, please try again.'],\n    defaultMessages: ['You have been successfully registered.'],\n  };\n  requestPass?: boolean | NbPasswordStrategyModule = {\n    endpoint: 'request-pass',\n    method: 'post',\n    redirect: {\n      success: '/',\n      failure: null,\n    },\n    defaultErrors: ['Something went wrong, please try again.'],\n    defaultMessages: ['Reset password instructions have been sent to your email.'],\n  };\n  resetPass?: boolean | NbPasswordStrategyReset = {\n    endpoint: 'reset-pass',\n    method: 'put',\n    redirect: {\n      success: '/',\n      failure: null,\n    },\n    resetPasswordTokenKey: 'reset_password_token',\n    defaultErrors: ['Something went wrong, please try again.'],\n    defaultMessages: ['Your password has been successfully changed.'],\n  };\n  logout?: boolean | NbPasswordStrategyReset = {\n    alwaysFail: false,\n    endpoint: 'logout',\n    method: 'delete',\n    redirect: {\n      success: '/',\n      failure: null,\n    },\n    defaultErrors: ['Something went wrong, please try again.'],\n    defaultMessages: ['You have been successfully logged out.'],\n  };\n  refreshToken?: boolean | NbPasswordStrategyModule = {\n    endpoint: 'refresh-token',\n    method: 'post',\n    requireValidToken: true,\n    redirect: {\n      success: null,\n      failure: null,\n    },\n    defaultErrors: ['Something went wrong, please try again.'],\n    defaultMessages: ['Your token has been successfully refreshed.'],\n  };\n  token?: NbPasswordStrategyToken = {\n    class: NbAuthSimpleToken,\n    key: 'data.token',\n    getter: (module: string, res: HttpResponse<Object>, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n      res.body,\n      options.token.key,\n    ),\n  };\n  errors?: NbPasswordStrategyMessage = {\n    key: 'data.errors',\n    getter: (module: string, res: HttpErrorResponse, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n      res.error,\n      options.errors.key,\n      options[module].defaultErrors,\n    ),\n  };\n  messages?: NbPasswordStrategyMessage = {\n    key: 'data.messages',\n    getter: (module: string, res: HttpResponse<Object>, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n      res.body,\n      options.messages.key,\n      options[module].defaultMessages,\n    ),\n  };\n  validation?: {\n    password?: {\n      required?: boolean;\n      minLength?: number | null;\n      maxLength?: number | null;\n      regexp?: string | null;\n    };\n    email?: {\n      required?: boolean;\n      regexp?: string | null;\n    };\n    fullName?: {\n      required?: boolean;\n      minLength?: number | null;\n      maxLength?: number | null;\n      regexp?: string | null;\n    };\n  };\n}\n\nexport const passwordStrategyOptions: NbPasswordAuthStrategyOptions = new NbPasswordAuthStrategyOptions();\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { Injectable } from '@angular/core';\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\nimport { ActivatedRoute } from '@angular/router';\nimport { Observable, of as observableOf } from 'rxjs';\nimport { switchMap, map, catchError } from 'rxjs/operators';\n\nimport { NbAuthResult } from '../../services/auth-result';\nimport { NbAuthStrategy } from '../auth-strategy';\nimport { NbAuthStrategyClass } from '../../auth.options';\nimport { NbPasswordAuthStrategyOptions, passwordStrategyOptions } from './password-strategy-options';\nimport { NbAuthIllegalTokenError } from '../../services/token/token';\n\n/**\n * The most common authentication provider for email/password strategy.\n *\n * Strategy settings. Note, there is no need to copy over the whole object to change the settings you need.\n * Also, this.getOption call won't work outside of the default options declaration\n * (which is inside of the `NbPasswordAuthStrategy` class), so you have to replace it with a custom helper function\n * if you need it.\n *\n * ```ts\n *export class NbPasswordAuthStrategyOptions extends NbAuthStrategyOptions {\n *  name: string;\n *  baseEndpoint? = '/api/auth/';\n *  login?: boolean | NbPasswordStrategyModule = {\n *    alwaysFail: false,\n *    endpoint: 'login',\n *    method: 'post',\n *    requireValidToken: true,\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Login/Email combination is not correct, please try again.'],\n *    defaultMessages: ['You have been successfully logged in.'],\n *  };\n *  register?: boolean | NbPasswordStrategyModule = {\n *    alwaysFail: false,\n *    endpoint: 'register',\n *    method: 'post',\n *    requireValidToken: true,\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['You have been successfully registered.'],\n *  };\n *  requestPass?: boolean | NbPasswordStrategyModule = {\n *    endpoint: 'request-pass',\n *    method: 'post',\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['Reset password instructions have been sent to your email.'],\n *  };\n *  resetPass?: boolean | NbPasswordStrategyReset = {\n *    endpoint: 'reset-pass',\n *    method: 'put',\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    resetPasswordTokenKey: 'reset_password_token',\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['Your password has been successfully changed.'],\n *  };\n *  logout?: boolean | NbPasswordStrategyReset = {\n *    alwaysFail: false,\n *    endpoint: 'logout',\n *    method: 'delete',\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['You have been successfully logged out.'],\n *  };\n *  refreshToken?: boolean | NbPasswordStrategyModule = {\n *    endpoint: 'refresh-token',\n *    method: 'post',\n *    requireValidToken: true,\n *    redirect: {\n *      success: null,\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['Your token has been successfully refreshed.'],\n *  };\n *  token?: NbPasswordStrategyToken = {\n *    class: NbAuthSimpleToken,\n *    key: 'data.token',\n *    getter: (module: string, res: HttpResponse<Object>, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n *      res.body,\n *      options.token.key,\n *    ),\n *  };\n *  errors?: NbPasswordStrategyMessage = {\n *    key: 'data.errors',\n *    getter: (module: string, res: HttpErrorResponse, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n *      res.error,\n *      options.errors.key,\n *      options[module].defaultErrors,\n *    ),\n *  };\n *  messages?: NbPasswordStrategyMessage = {\n *    key: 'data.messages',\n *    getter: (module: string, res: HttpResponse<Object>, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n *      res.body,\n *      options.messages.key,\n *      options[module].defaultMessages,\n *    ),\n *  };\n *  validation?: {\n *    password?: {\n *      required?: boolean;\n *      minLength?: number | null;\n *      maxLength?: number | null;\n *      regexp?: string | null;\n *    };\n *    email?: {\n *      required?: boolean;\n *      regexp?: string | null;\n *    };\n *    fullName?: {\n *      required?: boolean;\n *      minLength?: number | null;\n *      maxLength?: number | null;\n *      regexp?: string | null;\n *    };\n *  };\n *}\n * ```\n */\n@Injectable()\nexport class NbPasswordAuthStrategy extends NbAuthStrategy {\n  protected defaultOptions: NbPasswordAuthStrategyOptions = passwordStrategyOptions;\n\n  static setup(options: NbPasswordAuthStrategyOptions): [NbAuthStrategyClass, NbPasswordAuthStrategyOptions] {\n    return [NbPasswordAuthStrategy, options];\n  }\n\n  constructor(protected http: HttpClient, private route: ActivatedRoute) {\n    super();\n  }\n\n  authenticate(data?: any): Observable<NbAuthResult> {\n    const module = 'login';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    return this.http.request(method, url, { body: data, observe: 'response', headers: this.getHeaders() }).pipe(\n      map((res) => {\n        if (this.getOption(`${module}.alwaysFail`)) {\n          throw this.createFailResponse(data);\n        }\n        return res;\n      }),\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption(`${module}.redirect.success`),\n          [],\n          this.getOption('messages.getter')(module, res, this.options),\n          this.createToken(this.getOption('token.getter')(module, res, this.options), requireValidToken),\n        );\n      }),\n      catchError((res) => {\n        return this.handleResponseError(res, module);\n      }),\n    );\n  }\n\n  register(data?: any): Observable<NbAuthResult> {\n    const module = 'register';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    return this.http.request(method, url, { body: data, observe: 'response', headers: this.getHeaders() }).pipe(\n      map((res) => {\n        if (this.getOption(`${module}.alwaysFail`)) {\n          throw this.createFailResponse(data);\n        }\n\n        return res;\n      }),\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption(`${module}.redirect.success`),\n          [],\n          this.getOption('messages.getter')(module, res, this.options),\n          this.createToken(this.getOption('token.getter')('login', res, this.options), requireValidToken),\n        );\n      }),\n      catchError((res) => {\n        return this.handleResponseError(res, module);\n      }),\n    );\n  }\n\n  requestPassword(data?: any): Observable<NbAuthResult> {\n    const module = 'requestPass';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    return this.http.request(method, url, { body: data, observe: 'response', headers: this.getHeaders() }).pipe(\n      map((res) => {\n        if (this.getOption(`${module}.alwaysFail`)) {\n          throw this.createFailResponse();\n        }\n\n        return res;\n      }),\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption(`${module}.redirect.success`),\n          [],\n          this.getOption('messages.getter')(module, res, this.options),\n        );\n      }),\n      catchError((res) => {\n        return this.handleResponseError(res, module);\n      }),\n    );\n  }\n\n  resetPassword(data: any = {}): Observable<NbAuthResult> {\n    const module = 'resetPass';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const tokenKey = this.getOption(`${module}.resetPasswordTokenKey`);\n    data[tokenKey] = this.route.snapshot.queryParams[tokenKey];\n    return this.http.request(method, url, { body: data, observe: 'response', headers: this.getHeaders() }).pipe(\n      map((res) => {\n        if (this.getOption(`${module}.alwaysFail`)) {\n          throw this.createFailResponse();\n        }\n\n        return res;\n      }),\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption(`${module}.redirect.success`),\n          [],\n          this.getOption('messages.getter')(module, res, this.options),\n        );\n      }),\n      catchError((res) => {\n        return this.handleResponseError(res, module);\n      }),\n    );\n  }\n\n  logout(): Observable<NbAuthResult> {\n    const module = 'logout';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n\n    return observableOf({}).pipe(\n      switchMap((res: any) => {\n        if (!url) {\n          return observableOf(res);\n        }\n        return this.http.request(method, url, { observe: 'response', headers: this.getHeaders() });\n      }),\n      map((res) => {\n        if (this.getOption(`${module}.alwaysFail`)) {\n          throw this.createFailResponse();\n        }\n\n        return res;\n      }),\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption(`${module}.redirect.success`),\n          [],\n          this.getOption('messages.getter')(module, res, this.options),\n        );\n      }),\n      catchError((res) => {\n        return this.handleResponseError(res, module);\n      }),\n    );\n  }\n\n  refreshToken(data?: any): Observable<NbAuthResult> {\n    const module = 'refreshToken';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n\n    return this.http.request(method, url, { body: data, observe: 'response', headers: this.getHeaders() }).pipe(\n      map((res) => {\n        if (this.getOption(`${module}.alwaysFail`)) {\n          throw this.createFailResponse(data);\n        }\n\n        return res;\n      }),\n      map((res) => {\n        return new NbAuthResult(\n          true,\n          res,\n          this.getOption(`${module}.redirect.success`),\n          [],\n          this.getOption('messages.getter')(module, res, this.options),\n          this.createToken(this.getOption('token.getter')(module, res, this.options), requireValidToken),\n        );\n      }),\n      catchError((res) => {\n        return this.handleResponseError(res, module);\n      }),\n    );\n  }\n\n  protected handleResponseError(res: any, module: string): Observable<NbAuthResult> {\n    let errors = [];\n    if (res instanceof HttpErrorResponse) {\n      errors = this.getOption('errors.getter')(module, res, this.options);\n    } else if (res instanceof NbAuthIllegalTokenError) {\n      errors.push(res.message);\n    } else {\n      errors.push('Something went wrong.');\n    }\n    return observableOf(new NbAuthResult(false, res, this.getOption(`${module}.redirect.failure`), errors));\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nimport { Component } from '@angular/core';\n\n@Component({\n  selector: 'nb-auth-block',\n  styleUrls: ['./auth-block.component.scss'],\n  template: `\n    <ng-content></ng-content>\n  `,\n})\nexport class NbAuthBlockComponent {\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { Component, OnDestroy } from '@angular/core';\nimport { Location } from '@angular/common';\n\nimport { NbAuthService } from '../services/auth.service';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\n\n@Component({\n  selector: 'nb-auth',\n  styleUrls: ['./auth.component.scss'],\n  template: `\n    <nb-layout>\n      <nb-layout-column>\n        <nb-card>\n          <nb-card-header>\n            <nav class=\"navigation\">\n              <a href=\"#\" (click)=\"back()\" class=\"link back-link\" aria-label=\"Back\">\n                <nb-icon icon=\"arrow-back\"></nb-icon>\n              </a>\n            </nav>\n          </nb-card-header>\n          <nb-card-body>\n            <nb-auth-block>\n              <router-outlet></router-outlet>\n            </nb-auth-block>\n          </nb-card-body>\n        </nb-card>\n      </nb-layout-column>\n    </nb-layout>\n  `,\n})\nexport class NbAuthComponent implements OnDestroy {\n\n  private destroy$ = new Subject<void>();\n\n  subscription: any;\n\n  authenticated: boolean = false;\n  token: string = '';\n\n  // showcase of how to use the onAuthenticationChange method\n  constructor(protected auth: NbAuthService, protected location: Location) {\n\n    this.subscription = auth.onAuthenticationChange()\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((authenticated: boolean) => {\n        this.authenticated = authenticated;\n      });\n  }\n\n  back() {\n    this.location.back();\n    return false;\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { NB_AUTH_OPTIONS, NbAuthSocialLink } from '../../auth.options';\nimport { getDeepFromObject } from '../../helpers';\n\nimport { NbAuthService } from '../../services/auth.service';\nimport { NbAuthResult } from '../../services/auth-result';\n\n@Component({\n  selector: 'nb-login',\n  templateUrl: './login.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class NbLoginComponent {\n\n  redirectDelay: number = 0;\n  showMessages: any = {};\n  strategy: string = '';\n\n  errors: string[] = [];\n  messages: string[] = [];\n  user: any = {};\n  submitted: boolean = false;\n  socialLinks: NbAuthSocialLink[] = [];\n  rememberMe = false;\n\n  constructor(protected service: NbAuthService,\n              @Inject(NB_AUTH_OPTIONS) protected options = {},\n              protected cd: ChangeDetectorRef,\n              protected router: Router) {\n\n    this.redirectDelay = this.getConfigValue('forms.login.redirectDelay');\n    this.showMessages = this.getConfigValue('forms.login.showMessages');\n    this.strategy = this.getConfigValue('forms.login.strategy');\n    this.socialLinks = this.getConfigValue('forms.login.socialLinks');\n    this.rememberMe = this.getConfigValue('forms.login.rememberMe');\n  }\n\n  login(): void {\n    this.errors = [];\n    this.messages = [];\n    this.submitted = true;\n\n    this.service.authenticate(this.strategy, this.user).subscribe((result: NbAuthResult) => {\n      this.submitted = false;\n\n      if (result.isSuccess()) {\n        this.messages = result.getMessages();\n      } else {\n        this.errors = result.getErrors();\n      }\n\n      const redirect = result.getRedirect();\n      if (redirect) {\n        setTimeout(() => {\n          return this.router.navigateByUrl(redirect);\n        }, this.redirectDelay);\n      }\n      this.cd.detectChanges();\n    });\n  }\n\n  getConfigValue(key: string): any {\n    return getDeepFromObject(this.options, key, null);\n  }\n}\n","<h1 id=\"title\" class=\"title\">Login</h1>\n<p class=\"sub-title\">Hello! Log in with your email.</p>\n\n<nb-alert *ngIf=\"showMessages.error && errors?.length && !submitted\" outline=\"danger\" role=\"alert\">\n  <p class=\"alert-title\"><b>Oh snap!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let error of errors\" class=\"alert-message\">{{ error }}</li>\n  </ul>\n</nb-alert>\n\n<nb-alert *ngIf=\"showMessages.success && messages?.length && !submitted\" outline=\"success\" role=\"alert\">\n  <p class=\"alert-title\"><b>Hooray!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let message of messages\" class=\"alert-message\">{{ message }}</li>\n  </ul>\n</nb-alert>\n\n<form (ngSubmit)=\"login()\" #form=\"ngForm\" aria-labelledby=\"title\">\n\n  <div class=\"form-control-group\">\n    <label class=\"label\" for=\"input-email\">Email address:</label>\n    <input nbInput\n           fullWidth\n           [(ngModel)]=\"user.email\"\n           #email=\"ngModel\"\n           name=\"email\"\n           id=\"input-email\"\n           pattern=\".+@.+\\..+\"\n           placeholder=\"Email address\"\n           fieldSize=\"large\"\n           autofocus\n           [status]=\"email.dirty ? (email.invalid  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.email.required')\"\n           [attr.aria-invalid]=\"email.invalid && email.touched ? true : null\">\n    <ng-container *ngIf=\"email.invalid && email.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"email.errors?.required\">\n        Email is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"email.errors?.pattern\">\n        Email should be the real one!\n      </p>\n    </ng-container>\n  </div>\n\n  <div class=\"form-control-group\">\n    <span class=\"label-with-link\">\n      <label class=\"label\" for=\"input-password\">Password:</label>\n      <a class=\"forgot-password caption-2\" routerLink=\"../request-password\">Forgot Password?</a>\n    </span>\n    <input nbInput\n           fullWidth\n           [(ngModel)]=\"user.password\"\n           #password=\"ngModel\"\n           name=\"password\"\n           type=\"password\"\n           id=\"input-password\"\n           placeholder=\"Password\"\n           fieldSize=\"large\"\n           [status]=\"password.dirty ? (password.invalid  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.password.required')\"\n           [minlength]=\"getConfigValue('forms.validation.password.minLength')\"\n           [maxlength]=\"getConfigValue('forms.validation.password.maxLength')\"\n           [attr.aria-invalid]=\"password.invalid && password.touched ? true : null\">\n    <ng-container *ngIf=\"password.invalid && password.touched \">\n      <p class=\"caption status-danger\" *ngIf=\"password.errors?.required\">\n        Password is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"password.errors?.minlength || password.errors?.maxlength\">\n        Password should contain\n        from {{ getConfigValue('forms.validation.password.minLength') }}\n        to {{ getConfigValue('forms.validation.password.maxLength') }}\n        characters\n      </p>\n    </ng-container>\n  </div>\n\n  <div class=\"form-control-group accept-group\">\n    <nb-checkbox name=\"rememberMe\" [(ngModel)]=\"user.rememberMe\" *ngIf=\"rememberMe\">Remember me</nb-checkbox>\n  </div>\n\n  <button nbButton\n          fullWidth\n          status=\"primary\"\n          size=\"large\"\n          [disabled]=\"submitted || !form.valid\"\n          [class.btn-pulse]=\"submitted\">\n    Log In\n  </button>\n</form>\n\n<section *ngIf=\"socialLinks && socialLinks.length > 0\" class=\"links\" aria-label=\"Social sign in\">\n  or enter with:\n  <div class=\"socials\">\n    <ng-container *ngFor=\"let socialLink of socialLinks\">\n      <a *ngIf=\"socialLink.link\"\n         [routerLink]=\"socialLink.link\"\n         [attr.target]=\"socialLink.target\"\n         [attr.class]=\"socialLink.icon\"\n         [class.with-icon]=\"socialLink.icon\">\n        <nb-icon *ngIf=\"socialLink.icon; else title\" [icon]=\"socialLink.icon\"></nb-icon>\n        <ng-template #title>{{ socialLink.title }}</ng-template>\n      </a>\n      <a *ngIf=\"socialLink.url\"\n         [attr.href]=\"socialLink.url\"\n         [attr.target]=\"socialLink.target\"\n         [attr.class]=\"socialLink.icon\"\n         [class.with-icon]=\"socialLink.icon\">\n        <nb-icon *ngIf=\"socialLink.icon; else title\" [icon]=\"socialLink.icon\"></nb-icon>\n        <ng-template #title>{{ socialLink.title }}</ng-template>\n      </a>\n    </ng-container>\n  </div>\n</section>\n\n<section class=\"another-action\" aria-label=\"Register\">\n  Don't have an account? <a class=\"text-link\" routerLink=\"../register\">Register</a>\n</section>\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { NB_AUTH_OPTIONS, NbAuthSocialLink } from '../../auth.options';\nimport { getDeepFromObject } from '../../helpers';\n\nimport { NbAuthService } from '../../services/auth.service';\nimport { NbAuthResult } from '../../services/auth-result';\n\n\n@Component({\n  selector: 'nb-register',\n  styleUrls: ['./register.component.scss'],\n  templateUrl: './register.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class NbRegisterComponent {\n\n  redirectDelay: number = 0;\n  showMessages: any = {};\n  strategy: string = '';\n\n  submitted = false;\n  errors: string[] = [];\n  messages: string[] = [];\n  user: any = {};\n  socialLinks: NbAuthSocialLink[] = [];\n\n  constructor(protected service: NbAuthService,\n              @Inject(NB_AUTH_OPTIONS) protected options = {},\n              protected cd: ChangeDetectorRef,\n              protected router: Router) {\n\n    this.redirectDelay = this.getConfigValue('forms.register.redirectDelay');\n    this.showMessages = this.getConfigValue('forms.register.showMessages');\n    this.strategy = this.getConfigValue('forms.register.strategy');\n    this.socialLinks = this.getConfigValue('forms.login.socialLinks');\n  }\n\n  register(): void {\n    this.errors = this.messages = [];\n    this.submitted = true;\n\n    this.service.register(this.strategy, this.user).subscribe((result: NbAuthResult) => {\n      this.submitted = false;\n      if (result.isSuccess()) {\n        this.messages = result.getMessages();\n      } else {\n        this.errors = result.getErrors();\n      }\n\n      const redirect = result.getRedirect();\n      if (redirect) {\n        setTimeout(() => {\n          return this.router.navigateByUrl(redirect);\n        }, this.redirectDelay);\n      }\n      this.cd.detectChanges();\n    });\n  }\n\n  getConfigValue(key: string): any {\n    return getDeepFromObject(this.options, key, null);\n  }\n}\n","<h1 id=\"title\" class=\"title\">Register</h1>\n\n<nb-alert *ngIf=\"showMessages.error && errors?.length && !submitted\" outline=\"danger\" role=\"alert\">\n  <p class=\"alert-title\"><b>Oh snap!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let error of errors\" class=\"alert-message\">{{ error }}</li>\n  </ul>\n</nb-alert>\n\n<nb-alert *ngIf=\"showMessages.success && messages?.length && !submitted\" outline=\"success\" role=\"alert\">\n  <p class=\"alert-title\"><b>Hooray!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let message of messages\" class=\"alert-message\">{{ message }}</li>\n  </ul>\n</nb-alert>\n\n<form (ngSubmit)=\"register()\" #form=\"ngForm\" aria-labelledby=\"title\">\n\n  <div class=\"form-control-group\">\n    <label class=\"label\" for=\"input-name\">Full name:</label>\n    <input nbInput\n           [(ngModel)]=\"user.fullName\"\n           #fullName=\"ngModel\"\n           id=\"input-name\"\n           name=\"fullName\"\n           placeholder=\"Full name\"\n           autofocus\n           fullWidth\n           fieldSize=\"large\"\n           [status]=\"fullName.dirty ? (fullName.invalid  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.fullName.required')\"\n           [minlength]=\"getConfigValue('forms.validation.fullName.minLength')\"\n           [maxlength]=\"getConfigValue('forms.validation.fullName.maxLength')\"\n           [attr.aria-invalid]=\"fullName.invalid && fullName.touched ? true : null\">\n    <ng-container *ngIf=\"fullName.invalid && fullName.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"fullName.errors?.required\">\n        Full name is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"fullName.errors?.minlength || fullName.errors?.maxlength\">\n        Full name should contains\n        from {{getConfigValue('forms.validation.fullName.minLength')}}\n        to {{getConfigValue('forms.validation.fullName.maxLength')}}\n        characters\n      </p>\n    </ng-container>\n  </div>\n\n  <div class=\"form-control-group\">\n    <label class=\"label\" for=\"input-email\">Email address:</label>\n    <input nbInput\n           [(ngModel)]=\"user.email\"\n           #email=\"ngModel\"\n           id=\"input-email\"\n           name=\"email\"\n           pattern=\".+@.+..+\"\n           placeholder=\"Email address\"\n           fullWidth\n           fieldSize=\"large\"\n           [status]=\"email.dirty ? (email.invalid  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.email.required')\"\n           [attr.aria-invalid]=\"email.invalid && email.touched ? true : null\">\n    <ng-container *ngIf=\"email.invalid && email.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"email.errors?.required\">\n        Email is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"email.errors?.pattern\">\n        Email should be the real one!\n      </p>\n    </ng-container>\n  </div>\n\n  <div class=\"form-control-group\">\n    <label class=\"label\" for=\"input-password\">Password:</label>\n    <input nbInput\n           [(ngModel)]=\"user.password\"\n           #password=\"ngModel\"\n           type=\"password\"\n           id=\"input-password\"\n           name=\"password\"\n           placeholder=\"Password\"\n           fullWidth\n           fieldSize=\"large\"\n           [status]=\"password.dirty ? (password.invalid  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.password.required')\"\n           [minlength]=\"getConfigValue('forms.validation.password.minLength')\"\n           [maxlength]=\"getConfigValue('forms.validation.password.maxLength')\"\n           [attr.aria-invalid]=\"password.invalid && password.touched ? true : null\">\n    <ng-container *ngIf=\"password.invalid && password.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"password.errors?.required\">\n        Password is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"password.errors?.minlength || password.errors?.maxlength\">\n        Password should contain\n        from {{ getConfigValue('forms.validation.password.minLength') }}\n        to {{ getConfigValue('forms.validation.password.maxLength') }}\n        characters\n      </p>\n    </ng-container>\n  </div>\n\n  <div class=\"form-control-group\">\n    <label class=\"label\" for=\"input-re-password\">Repeat password:</label>\n    <input nbInput\n           [(ngModel)]=\"user.confirmPassword\"\n           #rePass=\"ngModel\"\n           type=\"password\"\n           id=\"input-re-password\"\n           name=\"rePass\"\n           placeholder=\"Confirm Password\"\n           fullWidth\n           fieldSize=\"large\"\n           [status]=\"rePass.dirty ? (rePass.invalid || password.value != rePass.value  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.password.required')\"\n           [attr.aria-invalid]=\"rePass.invalid && rePass.touched ? true : null\">\n    <ng-container *ngIf=\"rePass.invalid && rePass.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"rePass.errors?.required\">\n        Password confirmation is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"password.value != rePass.value && !rePass.errors?.required\">\n        Password does not match the confirm password.\n      </p>\n    </ng-container>\n  </div>\n\n  <div class=\"form-control-group accept-group\" *ngIf=\"getConfigValue('forms.register.terms')\">\n    <nb-checkbox name=\"terms\" [(ngModel)]=\"user.terms\" [required]=\"getConfigValue('forms.register.terms')\">\n      Agree to <a href=\"#\" target=\"_blank\"><strong>Terms & Conditions</strong></a>\n    </nb-checkbox>\n  </div>\n\n  <button nbButton\n          fullWidth\n          status=\"primary\"\n          size=\"large\"\n          [disabled]=\"submitted || !form.valid\"\n          [class.btn-pulse]=\"submitted\">\n    Register\n  </button>\n</form>\n\n<section *ngIf=\"socialLinks && socialLinks.length > 0\" class=\"links\" aria-label=\"Social sign in\">\n  or enter with:\n  <div class=\"socials\">\n    <ng-container *ngFor=\"let socialLink of socialLinks\">\n      <a *ngIf=\"socialLink.link\"\n         [routerLink]=\"socialLink.link\"\n         [attr.target]=\"socialLink.target\"\n         [attr.class]=\"socialLink.icon\"\n         [class.with-icon]=\"socialLink.icon\">\n        <nb-icon *ngIf=\"socialLink.icon; else title\" [icon]=\"socialLink.icon\"></nb-icon>\n        <ng-template #title>{{ socialLink.title }}</ng-template>\n      </a>\n      <a *ngIf=\"socialLink.url\"\n         [attr.href]=\"socialLink.url\"\n         [attr.target]=\"socialLink.target\"\n         [attr.class]=\"socialLink.icon\"\n         [class.with-icon]=\"socialLink.icon\">\n        <nb-icon *ngIf=\"socialLink.icon; else title\" [icon]=\"socialLink.icon\"></nb-icon>\n        <ng-template #title>{{ socialLink.title }}</ng-template>\n      </a>\n    </ng-container>\n  </div>\n</section>\n\n<section class=\"another-action\" aria-label=\"Sign in\">\n  Already have an account? <a class=\"text-link\" routerLink=\"../login\">Log in</a>\n</section>\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { Component, Inject, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { NB_AUTH_OPTIONS } from '../../auth.options';\nimport { getDeepFromObject } from '../../helpers';\nimport { NbAuthService } from '../../services/auth.service';\nimport { NbAuthResult } from '../../services/auth-result';\n\n@Component({\n  selector: 'nb-logout',\n  templateUrl: './logout.component.html',\n})\nexport class NbLogoutComponent implements OnInit {\n\n  redirectDelay: number = 0;\n  strategy: string = '';\n\n  constructor(protected service: NbAuthService,\n              @Inject(NB_AUTH_OPTIONS) protected options = {},\n              protected router: Router) {\n    this.redirectDelay = this.getConfigValue('forms.logout.redirectDelay');\n    this.strategy = this.getConfigValue('forms.logout.strategy');\n  }\n\n  ngOnInit(): void {\n    this.logout(this.strategy);\n  }\n\n  logout(strategy: string): void {\n    this.service.logout(strategy).subscribe((result: NbAuthResult) => {\n\n      const redirect = result.getRedirect();\n      if (redirect) {\n        setTimeout(() => {\n          return this.router.navigateByUrl(redirect);\n        }, this.redirectDelay);\n      }\n    });\n  }\n\n  getConfigValue(key: string): any {\n    return getDeepFromObject(this.options, key, null);\n  }\n}\n","<div>Logging out, please wait...</div>\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { NB_AUTH_OPTIONS } from '../../auth.options';\nimport { getDeepFromObject } from '../../helpers';\n\nimport { NbAuthService } from '../../services/auth.service';\nimport { NbAuthResult } from '../../services/auth-result';\n\n@Component({\n  selector: 'nb-request-password-page',\n  styleUrls: ['./request-password.component.scss'],\n  templateUrl: './request-password.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class NbRequestPasswordComponent {\n\n  redirectDelay: number = 0;\n  showMessages: any = {};\n  strategy: string = '';\n\n  submitted = false;\n  errors: string[] = [];\n  messages: string[] = [];\n  user: any = {};\n\n  constructor(protected service: NbAuthService,\n              @Inject(NB_AUTH_OPTIONS) protected options = {},\n              protected cd: ChangeDetectorRef,\n              protected router: Router) {\n\n    this.redirectDelay = this.getConfigValue('forms.requestPassword.redirectDelay');\n    this.showMessages = this.getConfigValue('forms.requestPassword.showMessages');\n    this.strategy = this.getConfigValue('forms.requestPassword.strategy');\n  }\n\n  requestPass(): void {\n    this.errors = this.messages = [];\n    this.submitted = true;\n\n    this.service.requestPassword(this.strategy, this.user).subscribe((result: NbAuthResult) => {\n      this.submitted = false;\n      if (result.isSuccess()) {\n        this.messages = result.getMessages();\n      } else {\n        this.errors = result.getErrors();\n      }\n\n      const redirect = result.getRedirect();\n      if (redirect) {\n        setTimeout(() => {\n          return this.router.navigateByUrl(redirect);\n        }, this.redirectDelay);\n      }\n      this.cd.detectChanges();\n    });\n  }\n\n  getConfigValue(key: string): any {\n    return getDeepFromObject(this.options, key, null);\n  }\n}\n","<h1 id=\"title\" class=\"title\">Forgot Password</h1>\n<p class=\"sub-title\">Enter your email address and well send a link to reset your password</p>\n\n<nb-alert *ngIf=\"showMessages.error && errors?.length && !submitted\" outline=\"danger\" role=\"alert\">\n  <p class=\"alert-title\"><b>Oh snap!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let error of errors\" class=\"alert-message\">{{ error }}</li>\n  </ul>\n</nb-alert>\n\n<nb-alert *ngIf=\"showMessages.success && messages?.length && !submitted\" outline=\"success\" role=\"alert\">\n  <p class=\"alert-title\"><b>Hooray!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let message of messages\" class=\"alert-message\">{{ message }}</li>\n  </ul>\n</nb-alert>\n\n<form (ngSubmit)=\"requestPass()\" #requestPassForm=\"ngForm\" aria-labelledby=\"title\">\n\n  <div class=\"form-control-group\">\n    <label class=\"label\" for=\"input-email\">Enter your email address:</label>\n    <input nbInput\n           [(ngModel)]=\"user.email\"\n           #email=\"ngModel\"\n           id=\"input-email\"\n           name=\"email\"\n           pattern=\".+@.+\\..+\"\n           placeholder=\"Email address\"\n           autofocus\n           fullWidth\n           fieldSize=\"large\"\n           [status]=\"email.dirty ? (email.invalid  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.email.required')\"\n           [attr.aria-invalid]=\"email.invalid && email.touched ? true : null\">\n    <ng-container *ngIf=\"email.invalid && email.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"email.errors?.required\">\n        Email is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"email.errors?.pattern\">\n        Email should be the real one!\n      </p>\n    </ng-container>\n  </div>\n\n  <button nbButton\n          fullWidth\n          status=\"primary\"\n          size=\"large\"\n          [disabled]=\"submitted || !requestPassForm.valid\"\n          [class.btn-pulse]=\"submitted\">\n    Request password\n  </button>\n</form>\n\n<section class=\"sign-in-or-up\" aria-label=\"Sign in or sign up\">\n  <p><a class=\"text-link\" routerLink=\"../login\">Back to Log In</a></p>\n  <p><a routerLink=\"../register\" class=\"text-link\">Register</a></p>\n</section>\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { NB_AUTH_OPTIONS } from '../../auth.options';\nimport { getDeepFromObject } from '../../helpers';\n\nimport { NbAuthService } from '../../services/auth.service';\nimport { NbAuthResult } from '../../services/auth-result';\n\n@Component({\n  selector: 'nb-reset-password-page',\n  styleUrls: ['./reset-password.component.scss'],\n  templateUrl: './reset-password.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class NbResetPasswordComponent {\n\n  redirectDelay: number = 0;\n  showMessages: any = {};\n  strategy: string = '';\n\n  submitted = false;\n  errors: string[] = [];\n  messages: string[] = [];\n  user: any = {};\n\n  constructor(protected service: NbAuthService,\n              @Inject(NB_AUTH_OPTIONS) protected options = {},\n              protected cd: ChangeDetectorRef,\n              protected router: Router) {\n\n    this.redirectDelay = this.getConfigValue('forms.resetPassword.redirectDelay');\n    this.showMessages = this.getConfigValue('forms.resetPassword.showMessages');\n    this.strategy = this.getConfigValue('forms.resetPassword.strategy');\n  }\n\n  resetPass(): void {\n    this.errors = this.messages = [];\n    this.submitted = true;\n\n    this.service.resetPassword(this.strategy, this.user).subscribe((result: NbAuthResult) => {\n      this.submitted = false;\n      if (result.isSuccess()) {\n        this.messages = result.getMessages();\n      } else {\n        this.errors = result.getErrors();\n      }\n\n      const redirect = result.getRedirect();\n      if (redirect) {\n        setTimeout(() => {\n          return this.router.navigateByUrl(redirect);\n        }, this.redirectDelay);\n      }\n      this.cd.detectChanges();\n    });\n  }\n\n  getConfigValue(key: string): any {\n    return getDeepFromObject(this.options, key, null);\n  }\n}\n","<h1 id=\"title\" class=\"title\">Change password</h1>\n<p class=\"sub-title\">Please set a new password</p>\n\n<nb-alert *ngIf=\"showMessages.error && errors?.length && !submitted\" outline=\"danger\" role=\"alert\">\n  <p class=\"alert-title\"><b>Oh snap!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let error of errors\" class=\"alert-message\">{{ error }}</li>\n  </ul>\n</nb-alert>\n\n<nb-alert *ngIf=\"showMessages.success && messages?.length && !submitted\" outline=\"success\" role=\"alert\">\n  <p class=\"alert-title\"><b>Hooray!</b></p>\n  <ul class=\"alert-message-list\">\n    <li *ngFor=\"let message of messages\" class=\"alert-message\">{{ message }}</li>\n  </ul>\n</nb-alert>\n\n<form (ngSubmit)=\"resetPass()\" #resetPassForm=\"ngForm\" aria-labelledby=\"title\">\n\n  <div class=\"form-control-group\">\n    <label class=\"label\" for=\"input-password\">New Password:</label>\n    <input nbInput\n           [(ngModel)]=\"user.password\"\n           #password=\"ngModel\"\n           type=\"password\"\n           id=\"input-password\"\n           name=\"password\"\n           class=\"first\"\n           placeholder=\"New Password\"\n           autofocus\n           fullWidth\n           fieldSize=\"large\"\n           [status]=\"password.dirty ? (password.invalid  ? 'danger' : 'success') : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.password.required')\"\n           [minlength]=\"getConfigValue('forms.validation.password.minLength')\"\n           [maxlength]=\"getConfigValue('forms.validation.password.maxLength')\"\n           [attr.aria-invalid]=\"password.invalid && password.touched ? true : null\">\n    <ng-container *ngIf=\"password.invalid && password.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"password.errors?.required\">\n        Password is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"password.errors?.minlength || password.errors?.maxlength\">\n        Password should contains\n        from {{getConfigValue('forms.validation.password.minLength')}}\n        to {{getConfigValue('forms.validation.password.maxLength')}}\n        characters\n      </p>\n    </ng-container>\n  </div>\n\n  <div class=\"form-group\">\n    <label class=\"label\" for=\"input-re-password\">Confirm Password:</label>\n    <input nbInput\n           [(ngModel)]=\"user.confirmPassword\"\n           #rePass=\"ngModel\"\n           id=\"input-re-password\"\n           name=\"rePass\"\n           type=\"password\"\n           class=\"last\"\n           placeholder=\"Confirm Password\"\n           fullWidth\n           fieldSize=\"large\"\n           [status]=\"rePass.touched\n               ? (rePass.invalid || password.value != rePass.value ? 'danger' : 'success')\n               : 'basic'\"\n           [required]=\"getConfigValue('forms.validation.password.required')\"\n           [attr.aria-invalid]=\"rePass.invalid && rePass.touched ? true : null\">\n    <ng-container *ngIf=\"rePass.touched\">\n      <p class=\"caption status-danger\" *ngIf=\"rePass.invalid && rePass.errors?.required\">\n        Password confirmation is required!\n      </p>\n      <p class=\"caption status-danger\" *ngIf=\"password.value != rePass.value && !rePass.errors?.required\">\n        Password does not match the confirm password.\n      </p>\n    </ng-container>\n  </div>\n\n  <button nbButton\n          status=\"primary\"\n          fullWidth\n          size=\"large\"\n          [disabled]=\"submitted || !resetPassForm.valid\"\n          [class.btn-pulse]=\"submitted\">\n    Change password\n  </button>\n</form>\n\n<section class=\"sign-in-or-up\" aria-label=\"Sign in or sign up\">\n  <p><a class=\"text-link\" routerLink=\"../login\">Back to Log In</a></p>\n  <p><a class=\"text-link\" routerLink=\"../register\">Register</a></p>\n</section>\n","import { Injector, ModuleWithProviders, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { FormsModule } from '@angular/forms';\nimport { HttpRequest } from '@angular/common/http';\n\nimport {\n  NbAlertModule,\n  NbButtonModule,\n  NbCardModule,\n  NbCheckboxModule,\n  NbIconModule,\n  NbInputModule,\n  NbLayoutModule,\n} from '@nebular/theme';\n\nimport { NbAuthService } from './services/auth.service';\nimport { NbAuthSimpleToken, NbAuthTokenClass } from './services/token/token';\nimport { NbTokenLocalStorage, NbTokenStorage } from './services/token/token-storage';\nimport { NbTokenService } from './services/token/token.service';\nimport { NbAuthTokenParceler, NB_AUTH_FALLBACK_TOKEN } from './services/token/token-parceler';\nimport { NbAuthStrategy } from './strategies/auth-strategy';\nimport { NbAuthStrategyOptions } from './strategies/auth-strategy-options';\nimport { NbDummyAuthStrategy } from './strategies/dummy/dummy-strategy';\nimport { NbOAuth2AuthStrategy } from './strategies/oauth2/oauth2-strategy';\nimport { NbPasswordAuthStrategy } from './strategies/password/password-strategy';\n\nimport {\n  defaultAuthOptions,\n  NB_AUTH_INTERCEPTOR_HEADER,\n  NB_AUTH_OPTIONS,\n  NB_AUTH_STRATEGIES,\n  NB_AUTH_TOKEN_INTERCEPTOR_FILTER,\n  NB_AUTH_TOKENS,\n  NB_AUTH_USER_OPTIONS,\n  NbAuthOptions,\n  NbAuthStrategyClass,\n} from './auth.options';\n\nimport { NbAuthComponent } from './components/auth.component';\n\nimport { NbAuthBlockComponent } from './components/auth-block/auth-block.component';\nimport { NbLoginComponent } from './components/login/login.component';\nimport { NbRegisterComponent } from './components/register/register.component';\nimport { NbLogoutComponent } from './components/logout/logout.component';\nimport { NbRequestPasswordComponent } from './components/request-password/request-password.component';\nimport { NbResetPasswordComponent } from './components/reset-password/reset-password.component';\n\nimport { deepExtend } from './helpers';\n\nexport function nbStrategiesFactory(options: NbAuthOptions, injector: Injector): NbAuthStrategy[] {\n  const strategies = [];\n  options.strategies\n    .forEach(([strategyClass, strategyOptions]: [NbAuthStrategyClass, NbAuthStrategyOptions]) => {\n      const strategy: NbAuthStrategy = injector.get(strategyClass);\n      strategy.setOptions(strategyOptions);\n\n      strategies.push(strategy);\n    });\n  return strategies;\n}\n\nexport function nbTokensFactory(strategies: NbAuthStrategy[]): NbAuthTokenClass[] {\n  const tokens = [];\n  strategies\n    .forEach((strategy: NbAuthStrategy) => {\n      tokens.push(strategy.getOption('token.class'));\n    });\n  return tokens;\n}\n\nexport function nbOptionsFactory(options) {\n  return deepExtend(defaultAuthOptions, options);\n}\n\nexport function nbNoOpInterceptorFilter(req: HttpRequest<any>): boolean {\n  return true;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    NbLayoutModule,\n    NbCardModule,\n    NbCheckboxModule,\n    NbAlertModule,\n    NbInputModule,\n    NbButtonModule,\n    RouterModule,\n    FormsModule,\n    NbIconModule,\n  ],\n  declarations: [\n    NbAuthComponent,\n    NbAuthBlockComponent,\n    NbLoginComponent,\n    NbRegisterComponent,\n    NbRequestPasswordComponent,\n    NbResetPasswordComponent,\n    NbLogoutComponent,\n  ],\n  exports: [\n    NbAuthComponent,\n    NbAuthBlockComponent,\n    NbLoginComponent,\n    NbRegisterComponent,\n    NbRequestPasswordComponent,\n    NbResetPasswordComponent,\n    NbLogoutComponent,\n  ],\n})\nexport class NbAuthModule {\n  static forRoot(nbAuthOptions?: NbAuthOptions): ModuleWithProviders<NbAuthModule> {\n    return {\n      ngModule: NbAuthModule,\n      providers: [\n        { provide: NB_AUTH_USER_OPTIONS, useValue: nbAuthOptions },\n        { provide: NB_AUTH_OPTIONS, useFactory: nbOptionsFactory, deps: [NB_AUTH_USER_OPTIONS] },\n        { provide: NB_AUTH_STRATEGIES, useFactory: nbStrategiesFactory, deps: [NB_AUTH_OPTIONS, Injector] },\n        { provide: NB_AUTH_TOKENS, useFactory: nbTokensFactory, deps: [NB_AUTH_STRATEGIES] },\n        { provide: NB_AUTH_FALLBACK_TOKEN, useValue: NbAuthSimpleToken },\n        { provide: NB_AUTH_INTERCEPTOR_HEADER, useValue: 'Authorization' },\n        { provide: NB_AUTH_TOKEN_INTERCEPTOR_FILTER, useValue: nbNoOpInterceptorFilter },\n        { provide: NbTokenStorage, useClass: NbTokenLocalStorage },\n        NbAuthTokenParceler,\n        NbAuthService,\n        NbTokenService,\n        NbDummyAuthStrategy,\n        NbPasswordAuthStrategy,\n        NbOAuth2AuthStrategy,\n      ],\n    };\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nimport { Routes } from '@angular/router';\n\nimport { NbAuthComponent } from './components/auth.component';\nimport { NbLoginComponent } from './components/login/login.component';\nimport { NbRegisterComponent } from './components/register/register.component';\nimport { NbLogoutComponent } from './components/logout/logout.component';\nimport { NbRequestPasswordComponent } from './components/request-password/request-password.component';\nimport { NbResetPasswordComponent } from './components/reset-password/reset-password.component';\n\nexport const routes: Routes = [\n  {\n    path: 'auth',\n    component: NbAuthComponent,\n    children: [\n      {\n        path: '',\n        component: NbLoginComponent,\n      },\n      {\n        path: 'login',\n        component: NbLoginComponent,\n      },\n      {\n        path: 'register',\n        component: NbRegisterComponent,\n      },\n      {\n        path: 'logout',\n        component: NbLogoutComponent,\n      },\n      {\n        path: 'request-password',\n        component: NbRequestPasswordComponent,\n      },\n      {\n        path: 'reset-password',\n        component: NbResetPasswordComponent,\n      },\n    ],\n  },\n];\n","import { Inject, Injectable, Injector } from '@angular/core';\nimport { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { NbAuthToken } from '../token/token';\nimport { NbAuthService } from '../auth.service';\nimport { NB_AUTH_TOKEN_INTERCEPTOR_FILTER } from '../../auth.options';\n\n@Injectable()\nexport class NbAuthJWTInterceptor implements HttpInterceptor {\n\n  constructor(private injector: Injector,\n              @Inject(NB_AUTH_TOKEN_INTERCEPTOR_FILTER) protected filter) {\n  }\n\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    // do not intercept request whose urls are filtered by the injected filter\n      if (!this.filter(req)) {\n        return this.authService.isAuthenticatedOrRefresh()\n          .pipe(\n            switchMap(authenticated => {\n              if (authenticated) {\n                  return this.authService.getToken().pipe(\n                    switchMap((token: NbAuthToken) => {\n                      const JWT = `Bearer ${token.getValue()}`;\n                      req = req.clone({\n                        setHeaders: {\n                          Authorization: JWT,\n                        },\n                      });\n                      return next.handle(req);\n                    }),\n                  )\n              } else {\n                 // Request is sent to server without authentication so that the client code\n                 // receives the 401/403 error and can act as desired ('session expired', redirect to login, aso)\n                return next.handle(req);\n              }\n            }),\n          )\n      } else {\n      return next.handle(req);\n    }\n  }\n\n  protected get authService(): NbAuthService {\n    return this.injector.get(NbAuthService);\n  }\n\n}\n","import { Inject, Injectable, Injector } from '@angular/core';\nimport { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\n\nimport { NbAuthService } from '../auth.service';\nimport { NB_AUTH_INTERCEPTOR_HEADER } from '../../auth.options';\nimport { NbAuthToken } from '../token/token';\n\n@Injectable()\nexport class NbAuthSimpleInterceptor implements HttpInterceptor {\n  constructor(\n    private injector: Injector,\n    @Inject(NB_AUTH_INTERCEPTOR_HEADER) protected headerName: string = 'Authorization',\n  ) {}\n\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    return this.authService.getToken().pipe(\n      switchMap((token: NbAuthToken) => {\n        if (token && token.getValue()) {\n          req = req.clone({\n            setHeaders: {\n              [this.headerName]: token.getValue(),\n            },\n          });\n        }\n        return next.handle(req);\n      }),\n    );\n  }\n\n  protected get authService(): NbAuthService {\n    return this.injector.get(NbAuthService);\n  }\n}\n","export class NbUser {\n\n  constructor(public id?: number,\n              public email?: string,\n              public password?: string,\n              public rememberMe?: boolean,\n              public terms?: boolean,\n              public confirmPassword?: string,\n              public fullName?: string) {\n  }\n}\n","/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nexport * from './auth.options';\nexport * from './auth.module';\nexport * from './auth.routes';\n\nexport * from './components/auth.component';\nexport * from './components/auth-block/auth-block.component';\nexport * from './components/login/login.component';\nexport * from './components/logout/logout.component';\nexport * from './components/register/register.component';\nexport * from './components/request-password/request-password.component';\nexport * from './components/reset-password/reset-password.component';\nexport * from './services/auth.service';\nexport * from './services/auth-result';\nexport * from './services/interceptors/jwt-interceptor';\nexport * from './services/interceptors/simple-interceptor';\nexport * from './services/token/token';\nexport * from './services/token/token-storage';\nexport * from './services/token/token.service';\nexport * from './services/token/token-parceler';\nexport * from './strategies/auth-strategy';\nexport * from './strategies/auth-strategy-options';\nexport * from './strategies/dummy/dummy-strategy';\nexport * from './strategies/dummy/dummy-strategy-options';\nexport * from './strategies/password/password-strategy';\nexport * from './strategies/password/password-strategy-options';\nexport * from './strategies/oauth2/oauth2-strategy';\nexport * from './strategies/oauth2/oauth2-strategy.options';\nexport * from './models/user';\n\nexport * from './helpers';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["observableOf"],"mappings":"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"}